<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 7 Manipulación de datos ordenados usando {dplyr} y {tidyr} II | Documento Técnico N°6: Ciencia de Datos para el Turismo</title>
  <meta name="description" content="Ciencia de Datos para el Turismo" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 7 Manipulación de datos ordenados usando {dplyr} y {tidyr} II | Documento Técnico N°6: Ciencia de Datos para el Turismo" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Ciencia de Datos para el Turismo" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 7 Manipulación de datos ordenados usando {dplyr} y {tidyr} II | Documento Técnico N°6: Ciencia de Datos para el Turismo" />
  
  <meta name="twitter:description" content="Ciencia de Datos para el Turismo" />
  

<meta name="author" content="Dirección Nacional de Mercados y Estadísticas - Subsecretaría de Desarrollo Estratégico" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="gráficos-con-ggplot2.html"/>

<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="imagenes/escudo_mintur.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Presentación</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#documento-técnico-nº6---resumen"><i class="fa fa-check"></i>Documento Técnico Nº6 - Resumen</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ciencia-de-datos.html"><a href="ciencia-de-datos.html"><i class="fa fa-check"></i><b>1</b> Ciencia de Datos</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ciencia-de-datos.html"><a href="ciencia-de-datos.html#por-qué-r"><i class="fa fa-check"></i><b>1.1</b> ¿Por qué R?</a></li>
<li class="chapter" data-level="1.2" data-path="ciencia-de-datos.html"><a href="ciencia-de-datos.html#cómo-decirle-a-r-qué-hacer"><i class="fa fa-check"></i><b>1.2</b> Cómo decirle a R qué hacer</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ciencia-de-datos.html"><a href="ciencia-de-datos.html#orientándose-en-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> Orientándose en RStudio</a></li>
<li class="chapter" data-level="1.2.2" data-path="ciencia-de-datos.html"><a href="ciencia-de-datos.html#hablando-con-r"><i class="fa fa-check"></i><b>1.2.2</b> Hablando con R</a></li>
<li class="chapter" data-level="1.2.3" data-path="ciencia-de-datos.html"><a href="ciencia-de-datos.html#extendiendo-r"><i class="fa fa-check"></i><b>1.2.3</b> Extendiendo R</a></li>
<li class="chapter" data-level="1.2.4" data-path="ciencia-de-datos.html"><a href="ciencia-de-datos.html#buscando-ayuda"><i class="fa fa-check"></i><b>1.2.4</b> Buscando ayuda</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="trabajar-con-proyectos-en-rstudio.html"><a href="trabajar-con-proyectos-en-rstudio.html"><i class="fa fa-check"></i><b>2</b> Trabajar con proyectos en RStudio</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="trabajar-con-proyectos-en-rstudio.html"><a href="trabajar-con-proyectos-en-rstudio.html#qué-ventajas-tiene"><i class="fa fa-check"></i><b>2.0.1</b> ¿Qué ventajas tiene?</a></li>
<li class="chapter" data-level="2.0.2" data-path="trabajar-con-proyectos-en-rstudio.html"><a href="trabajar-con-proyectos-en-rstudio.html#abrir-un-proyecto"><i class="fa fa-check"></i><b>2.0.2</b> Abrir un proyecto</a></li>
<li class="chapter" data-level="2.0.3" data-path="trabajar-con-proyectos-en-rstudio.html"><a href="trabajar-con-proyectos-en-rstudio.html#cómo-se-organiza"><i class="fa fa-check"></i><b>2.0.3</b> ¿Cómo se organiza?</a></li>
<li class="chapter" data-level="2.0.4" data-path="trabajar-con-proyectos-en-rstudio.html"><a href="trabajar-con-proyectos-en-rstudio.html#borrón-y-cuenta-nueva-todos-los-días"><i class="fa fa-check"></i><b>2.0.4</b> Borrón y cuenta nueva… todos los días!</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introducción-a-rmarkdown.html"><a href="introducción-a-rmarkdown.html"><i class="fa fa-check"></i><b>3</b> Introducción a RMarkdown</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introducción-a-rmarkdown.html"><a href="introducción-a-rmarkdown.html#creando-archivos-.rmd"><i class="fa fa-check"></i><b>3.1</b> Creando archivos .Rmd</a></li>
<li class="chapter" data-level="3.2" data-path="introducción-a-rmarkdown.html"><a href="introducción-a-rmarkdown.html#estructura-de-un-.rmd"><i class="fa fa-check"></i><b>3.2</b> Estructura de un .Rmd</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="introducción-a-rmarkdown.html"><a href="introducción-a-rmarkdown.html#encabezado"><i class="fa fa-check"></i><b>3.2.1</b> Encabezado</a></li>
<li class="chapter" data-level="3.2.2" data-path="introducción-a-rmarkdown.html"><a href="introducción-a-rmarkdown.html#bloques-de-código"><i class="fa fa-check"></i><b>3.2.2</b> Bloques de código</a></li>
<li class="chapter" data-level="3.2.3" data-path="introducción-a-rmarkdown.html"><a href="introducción-a-rmarkdown.html#el-texto-propio-del-documento."><i class="fa fa-check"></i><b>3.2.3</b> El texto propio del documento.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introducción-a-rmarkdown.html"><a href="introducción-a-rmarkdown.html#markdown"><i class="fa fa-check"></i><b>3.3</b> Markdown</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lectura-de-datos-ordenados.html"><a href="lectura-de-datos-ordenados.html"><i class="fa fa-check"></i><b>4</b> Lectura de datos ordenados</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lectura-de-datos-ordenados.html"><a href="lectura-de-datos-ordenados.html#leer-datos-csv"><i class="fa fa-check"></i><b>4.1</b> Leer datos csv</a></li>
<li class="chapter" data-level="4.2" data-path="lectura-de-datos-ordenados.html"><a href="lectura-de-datos-ordenados.html#vectores"><i class="fa fa-check"></i><b>4.2</b> Vectores</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="lectura-de-datos-ordenados.html"><a href="lectura-de-datos-ordenados.html#vectorización"><i class="fa fa-check"></i><b>4.2.1</b> Vectorización</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lectura-de-datos-ordenados.html"><a href="lectura-de-datos-ordenados.html#leer-datos-de-excel"><i class="fa fa-check"></i><b>4.3</b> Leer datos de excel</a></li>
<li class="chapter" data-level="4.4" data-path="lectura-de-datos-ordenados.html"><a href="lectura-de-datos-ordenados.html#formatos-de-tablas"><i class="fa fa-check"></i><b>4.4</b> Formatos de tablas</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="manipulación-de-datos-ordenados.html"><a href="manipulación-de-datos-ordenados.html"><i class="fa fa-check"></i><b>5</b> Manipulación de datos ordenados</a>
<ul>
<li class="chapter" data-level="5.1" data-path="manipulación-de-datos-ordenados.html"><a href="manipulación-de-datos-ordenados.html#seleccionando-columnas-con-select"><i class="fa fa-check"></i><b>5.1</b> Seleccionando columnas con <code>select()</code></a></li>
<li class="chapter" data-level="5.2" data-path="manipulación-de-datos-ordenados.html"><a href="manipulación-de-datos-ordenados.html#filtrando-filas-con-filter"><i class="fa fa-check"></i><b>5.2</b> Filtrando filas con <code>filter()</code></a></li>
<li class="chapter" data-level="5.3" data-path="manipulación-de-datos-ordenados.html"><a href="manipulación-de-datos-ordenados.html#agrupando-y-reduciendo-con-group_by-summarise"><i class="fa fa-check"></i><b>5.3</b> Agrupando y reduciendo con <code>group_by() %&gt;% summarise()</code></a></li>
<li class="chapter" data-level="5.4" data-path="manipulación-de-datos-ordenados.html"><a href="manipulación-de-datos-ordenados.html#creando-nuevas-columnas-con-mutate"><i class="fa fa-check"></i><b>5.4</b> Creando nuevas columnas con <code>mutate()</code></a></li>
<li class="chapter" data-level="5.5" data-path="manipulación-de-datos-ordenados.html"><a href="manipulación-de-datos-ordenados.html#desagrupando-con-ungroup"><i class="fa fa-check"></i><b>5.5</b> Desagrupando con <code>ungroup()</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Gráficos con ggplot2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html#primera-capa-el-área-del-gráfico"><i class="fa fa-check"></i><b>6.1</b> Primera capa: el área del gráfico</a></li>
<li class="chapter" data-level="6.2" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html#segunda-capa-geometrías"><i class="fa fa-check"></i><b>6.2</b> Segunda capa: geometrías</a></li>
<li class="chapter" data-level="6.3" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html#mapear-variables-a-elementos"><i class="fa fa-check"></i><b>6.3</b> Mapear variables a elementos</a></li>
<li class="chapter" data-level="6.4" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html#otras-geometrías"><i class="fa fa-check"></i><b>6.4</b> Otras geometrías</a></li>
<li class="chapter" data-level="6.5" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html#relación-entre-variables"><i class="fa fa-check"></i><b>6.5</b> Relación entre variables</a></li>
<li class="chapter" data-level="6.6" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html#transformaciones-estadísticas"><i class="fa fa-check"></i><b>6.6</b> Transformaciones estadísticas</a></li>
<li class="chapter" data-level="6.7" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html#gráficos-de-frecuencias"><i class="fa fa-check"></i><b>6.7</b> Gráficos de frecuencias</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html#posición"><i class="fa fa-check"></i><b>6.7.1</b> Posición</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html#gráficos-de-líneas-suavizas"><i class="fa fa-check"></i><b>6.8</b> Gráficos de líneas suavizas</a></li>
<li class="chapter" data-level="6.9" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html#gráficos-de-caja"><i class="fa fa-check"></i><b>6.9</b> Gráficos de caja</a></li>
<li class="chapter" data-level="6.10" data-path="gráficos-con-ggplot2.html"><a href="gráficos-con-ggplot2.html#graficando-en-múltiples-paneles"><i class="fa fa-check"></i><b>6.10</b> Graficando en múltiples paneles</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><i class="fa fa-check"></i><b>7</b> Manipulación de datos ordenados usando {dplyr} y {tidyr} II</a>
<ul>
<li class="chapter" data-level="7.1" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#de-ancho-a-largo-con-pivot_longer"><i class="fa fa-check"></i><b>7.1</b> De ancho a largo con <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="7.2" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#de-largo-a-ancho-con-pivot_wider"><i class="fa fa-check"></i><b>7.2</b> De largo a ancho con <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="7.3" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#uniendo-tablas"><i class="fa fa-check"></i><b>7.3</b> Uniendo tablas</a></li>
<li class="chapter" data-level="7.4" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii-1"><i class="fa fa-check"></i><b>7.4</b> Manipulación de datos ordenados usando {dplyr} y {tidyr} II</a></li>
<li class="chapter" data-level="7.5" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#de-ancho-a-largo-con-pivot_longer-1"><i class="fa fa-check"></i><b>7.5</b> De ancho a largo con <code>pivot_longer()</code></a></li>
<li class="chapter" data-level="7.6" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#de-largo-a-ancho-con-pivot_wider-1"><i class="fa fa-check"></i><b>7.6</b> De largo a ancho con <code>pivot_wider()</code></a></li>
<li class="chapter" data-level="7.7" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#uniendo-tablas-1"><i class="fa fa-check"></i><b>7.7</b> Uniendo tablas</a></li>
<li class="chapter" data-level="7.8" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#reportes-ii"><i class="fa fa-check"></i><b>7.8</b> Reportes II</a></li>
<li class="chapter" data-level="7.9" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#eligiendo-el-formato-de-salida"><i class="fa fa-check"></i><b>7.9</b> Eligiendo el formato de salida</a></li>
<li class="chapter" data-level="7.10" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#personalizando-la-salida"><i class="fa fa-check"></i><b>7.10</b> Personalizando la salida</a></li>
<li class="chapter" data-level="7.11" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#reportes-parametrizados"><i class="fa fa-check"></i><b>7.11</b> Reportes parametrizados</a></li>
<li class="chapter" data-level="7.12" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#control-de-chunks"><i class="fa fa-check"></i><b>7.12</b> Control de chunks</a></li>
<li class="chapter" data-level="7.13" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#tablas"><i class="fa fa-check"></i><b>7.13</b> Tablas</a></li>
<li class="chapter" data-level="7.14" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#tablas-simples-con-kable"><i class="fa fa-check"></i><b>7.14</b> Tablas simples con <code>kable</code></a></li>
<li class="chapter" data-level="7.15" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#supertablas-con-kableextra"><i class="fa fa-check"></i><b>7.15</b> Supertablas con {kableExtra}</a></li>
<li class="chapter" data-level="7.16" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#apariencia-de-gráficos"><i class="fa fa-check"></i><b>7.16</b> Apariencia de gráficos</a></li>
<li class="chapter" data-level="7.17" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#escalas"><i class="fa fa-check"></i><b>7.17</b> Escalas</a>
<ul>
<li class="chapter" data-level="7.17.1" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#escala-de-colores-y-otras"><i class="fa fa-check"></i><b>7.17.1</b> Escala de colores y otras</a></li>
<li class="chapter" data-level="7.17.2" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#escalas-de-ejes"><i class="fa fa-check"></i><b>7.17.2</b> Escalas de ejes</a></li>
</ul></li>
<li class="chapter" data-level="7.18" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#elementos-de-texto"><i class="fa fa-check"></i><b>7.18</b> Elementos de texto</a></li>
<li class="chapter" data-level="7.19" data-path="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#temas"><i class="fa fa-check"></i><b>7.19</b> Temas</a></li>
</ul></li>
<li class="divider"></li>
<li><b><a href="http://www.yvera.gob.ar/estadistica" target="blank">Estadísticas de Turismo</a></b></li>
<li><a href="http://datos.yvera.gob.ar/" target="blank">Datos Abiertos de Turismo</a></li>
<li><a href="https://tableros.yvera.tur.ar/" target="blank">Tableros y Reportes</a></li>
<li><a href="https://www.yvera.tur.ar/estadistica/informe" target="blank">Informes</a></li>
<li><a href="https://armonizacion.yvera.tur.ar/" target="blank">Armonización</a></li>
<li><a href="https://bitacora.yvera.tur.ar/" target="blank">Bitácora</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Documento Técnico N°6: Ciencia de Datos para el Turismo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<link href="style.css" rel="stylesheet">
<div class="hero-image-container"> 
  <img class= "hero-image" src="imagenes/cabezal.png">
</div>
<div id="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii" class="section level1" number="7">
<h1><span class="header-section-number">Capítulo 7</span> Manipulación de datos ordenados usando {dplyr} y {tidyr} II</h1>
<p>En <a href="04-lectura-datos.html#Formatos_de_tablas">la última sección de lectura de datos</a> viste el concepto de datos “anchos” y “largos”.</p>
<p>Los datos en formato “largo” o “tidy”, son aquellos en los cuales:</p>
<ul>
<li>cada fila es una observación</li>
<li>cada columna es una variable</li>
</ul>
<p>En el formato “ancho” es un poco más complejo de definirlo pero la idea general es que:</p>
<ul>
<li>cada fila es un “item”</li>
<li>cada columna es una variable</li>
</ul>
<p><img src="img/largo-ancho.png" /></p>
<p>Una tabla en formato largo va a tener una cierta cantidad de columnas que cumplen el rol de <em>identificadores</em> y cuya combinación identifican una única observación y una única columna con el valor de la observación.
En el ejemplo de arriba, <code>pais</code> y <code>anio</code> son las columnas identificadoras y <code>casos</code> es la columna que contiene el valor de las observaciones.</p>
<p>En una tabla ancha, cada observación única se identifica a partir de la intersección de filas y columnas.
En el ejemplo, los países están en las filas y los años en las columnas.</p>
<p>En general, el formato ancho es más compacto y legible por humanos mientras que el largo es más fácil de manejar con la computadora.
Si te fijás en las tablas de arriba, es más fácil comparar los valores entre países y entre años en la tabla ancha.
Pero el nombre de las columnas (“1999”, “2000”) en realidad ¡son datos!
Además este formato se empieza a complicar en cuanto hay más de dos identificadores.</p>
<p>Un mismo set de datos puede ser representado de forma completamente “larga”, completamente “ancha” o –lo que es más común– en un formato intermedio pero no existe una forma “correcta” de organizar los datos; cada una tiene sus ventajas y desventajas.
Por esto es que es muy normal que durante un análisis los datos vayan y vuelvan entre distintos formatos dependiendo de los métodos estadísticos que se le aplican.
Entonces, aprender a transformar datos anchos en largos y viceversa es un habilidad muy útil.</p>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>En las tablas de ejemplo cada país tiene el un valor observado de “casos” para cada año.
¿Cómo agregarías una nueva variable con información sobre “precios”?
Dibujá un esquema en papel y lápiz en formato ancho y uno en formato largo.
¿En qué formato es más “natural” esa extensión?</p>
</div>
<p>En esta sección vas a usar el paquete {tidyr} para manipular datos.
Si no lo tenés instalado, instalalo con el comando:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyr&quot;</span>)</span></code></pre></div>
<p>(como siempre, recordá que esto hay que hacerlo una única vez)</p>
<p>Y luego cargá {tidyr} y {dplyr} (que usaste en <a href="05-dplyr-I.html">una sección anterior</a>) con:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb136-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div id="de-ancho-a-largo-con-pivot_longer" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> De ancho a largo con <code>pivot_longer()</code></h2>
<p>En secciones anteriores usaste una versión de los datos de <a href="https://www.gapminder.org/">gapminder</a>.
Ahora vas a leer los datos en su formato original:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb137-1" aria-hidden="true" tabindex="-1"></a>paises_ancho <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;datos/paises_ancho.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 142 Columns: 38</code></pre>
<pre><code>## ── Column specification ─────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (2): continente, pais
## dbl (36): pib_per_capita_1952, pib_per_capita_1957, pib_per_capit...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb141-1" aria-hidden="true" tabindex="-1"></a>paises_ancho</span></code></pre></div>
<pre><code>## # A tibble: 142 × 38
##    continente pais                     pib_per_capita_… pib_per_capita_…
##    &lt;chr&gt;      &lt;chr&gt;                               &lt;dbl&gt;            &lt;dbl&gt;
##  1 Africa     Algeria                             2449.            3014.
##  2 Africa     Angola                              3521.            3828.
##  3 Africa     Benin                               1063.             960.
##  4 Africa     Botswana                             851.             918.
##  5 Africa     Burkina Faso                         543.             617.
##  6 Africa     Burundi                              339.             380.
##  7 Africa     Cameroon                            1173.            1313.
##  8 Africa     Central African Republic            1071.            1191.
##  9 Africa     Chad                                1179.            1308.
## 10 Africa     Comoros                             1103.            1211.
## # … with 132 more rows, and 34 more variables:
## #   pib_per_capita_1962 &lt;dbl&gt;, pib_per_capita_1967 &lt;dbl&gt;,
## #   pib_per_capita_1972 &lt;dbl&gt;, pib_per_capita_1977 &lt;dbl&gt;,
## #   pib_per_capita_1982 &lt;dbl&gt;, pib_per_capita_1987 &lt;dbl&gt;,
## #   pib_per_capita_1992 &lt;dbl&gt;, pib_per_capita_1997 &lt;dbl&gt;,
## #   pib_per_capita_2002 &lt;dbl&gt;, pib_per_capita_2007 &lt;dbl&gt;,
## #   esperanza_de_vida_1952 &lt;dbl&gt;, esperanza_de_vida_1957 &lt;dbl&gt;, …</code></pre>
<div class="alert alert-success">
<p>¿Notaste que en el código anterior no usaste <code>library(readr)</code> para cargar el paquete y luego leer?
Con la notación <code>paquete::funcion()</code> podés acceder a las funciones de un paquete sin tener que cargarlo.
Es una buena forma de no tener que cargar un montón de paquetes innecesarios si vas a correr una única función de un paquete pocas veces.</p>
</div>
<p>Esta tabla, increíblemente ancha, es muy difícil de manejar.
Por ejemplo, es imposible hacer una serie de tiempo de una variable, o calcular el promedio por variable y país; ni hablar de calcular una regresión lineal.</p>
<p>Para convertirlo en una tabla más larga, se usa <code>pivot_longer()</code> (“longer” es “más largo” en inglés):</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb143-1" aria-hidden="true" tabindex="-1"></a>paises_largo <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(paises_ancho,</span>
<span id="cb143-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb143-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">cols =</span> <span class="fu">c</span>(<span class="fu">starts_with</span>(<span class="st">&#39;pob&#39;</span>), </span>
<span id="cb143-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb143-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">starts_with</span>(<span class="st">&#39;esperanza&#39;</span>), </span>
<span id="cb143-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb143-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">starts_with</span>(<span class="st">&#39;pib_per&#39;</span>)),</span>
<span id="cb143-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb143-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">names_to =</span> <span class="st">&quot;variable_anio&quot;</span>, </span>
<span id="cb143-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb143-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">values_to =</span> <span class="st">&quot;valor&quot;</span></span>
<span id="cb143-7"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb143-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb143-8"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb143-8" aria-hidden="true" tabindex="-1"></a>paises_largo</span></code></pre></div>
<pre><code>## # A tibble: 5,112 × 4
##    continente pais    variable_anio     valor
##    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;             &lt;dbl&gt;
##  1 Africa     Algeria poblacion_1952  9279525
##  2 Africa     Algeria poblacion_1957 10270856
##  3 Africa     Algeria poblacion_1962 11000948
##  4 Africa     Algeria poblacion_1967 12760499
##  5 Africa     Algeria poblacion_1972 14760787
##  6 Africa     Algeria poblacion_1977 17152804
##  7 Africa     Algeria poblacion_1982 20033753
##  8 Africa     Algeria poblacion_1987 23254956
##  9 Africa     Algeria poblacion_1992 26298373
## 10 Africa     Algeria poblacion_1997 29072015
## # … with 5,102 more rows</code></pre>
<p>El primer argumento de<code>pivot_longer()</code> es la tabla que va a modificar: <code>paises_ancho</code>.
El segundo argumento se llama <code>cols</code> y es un vector con las columnas que tienen los valores a “alargar”.
Podría ser un vector escrito a mano (algo como <code>c("pib_per_capita_1952", "pib_per_capita_1957"...)</code>) pero con más de 30 columnas, escribir todo eso sería tedioso y probablemente estaría lleno de errores.
Por eso {tidyr} provee funciones de ayuda para seleccionar columnas en base a patrones.
El código de arriba usa <code>starts_with()</code> que, como su nombre en inglés lo indica, selecciona las columnas que <em>empiezan con</em> una determinada cadena de caracteres.
El vector <code>c(starts_with('pob'), starts_with('esperanza'), starts_with('pib_per'))</code> le dice a <code>pivot_longer()</code> que seleccione las columnas que empieza con “pob”, las que empiezan con “esperanza” y las que empiezan con “pib_per”.</p>
<div class="alert alert-success">
<p>Estas funciones accesorias para seleccionar muchas funciones se llaman “tidyselect”.
Si querés leer más detalles de las distintas formas que podés seleccionar variables leé la documentación usando <code>?tidyselect::language</code>.</p>
</div>
<p>El tercer y cuarto argumento son los nombres de las columnas de “nombre” y de “valor” que va a tener la nueva tabla.
Como la nueva columna de identificación tiene los datos de la variable y el año a medir, “variable_anio” es un buen nombre.
Y la columna de valor va a tener… bueno, el valor.</p>
<p>Tomate un momento para visualizar lo que acaba de pasar.
La tabla ancha tenía un montón de columnas con distintos datos.
Ahora estos datos están uno arriba de otro en la columna “valor”, pero para identificar el nombre de la columna de la cual vinieron, se agrega la columna “variable_anio”.</p>
<div class="figure">
<img src="img/ancho-a-largo.png" alt="" />
<p class="caption">Proceso de largo a ancho</p>
</div>
<p>La columna <code>variable_anio</code> todavía no es muy útil porque contiene 2 datos, la variable (población, expectativa de vida o PBI per cápita) y el año.
Sería mejor separar esta información en dos columnas llamadas “variable” y “anio”.
Para eso está la función <code>separate()</code>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(paises_largo, </span>
<span id="cb145-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb145-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> variable_anio, </span>
<span id="cb145-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb145-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;anio&quot;</span>), </span>
<span id="cb145-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb145-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sep =</span> <span class="sc">-</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5,112 × 5
##    continente pais    variable   anio     valor
##    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
##  1 Africa     Algeria poblacion_ 1952   9279525
##  2 Africa     Algeria poblacion_ 1957  10270856
##  3 Africa     Algeria poblacion_ 1962  11000948
##  4 Africa     Algeria poblacion_ 1967  12760499
##  5 Africa     Algeria poblacion_ 1972  14760787
##  6 Africa     Algeria poblacion_ 1977  17152804
##  7 Africa     Algeria poblacion_ 1982  20033753
##  8 Africa     Algeria poblacion_ 1987  23254956
##  9 Africa     Algeria poblacion_ 1992  26298373
## 10 Africa     Algeria poblacion_ 1997  29072015
## # … with 5,102 more rows</code></pre>
<p>El primer argumento, como siempre, es la tabla a procesar.
El segundo, <code>col</code>, es la columna a separar en dos (o más) columnas nuevas.
El tercero, <code>into</code> es el nombre de las nuevas columnas que <code>separate()</code> va a crear.
El último argumento es <code>sep</code> que define cómo realizar la separación.
Por defecto, <code>sep</code> es una <a href="https://es.wikipedia.org/wiki/Expresi%C3%B3n_regular">expresión regular</a> que captura cualquier caracter no alfanumérico.
En el caso de <code>variable_anio</code> no sirve, porque para valores como <code>"esperanza_de_vida_1952"</code>, separaría en <code>"esperanza"</code>, <code>"de"</code>, <code>"vida"</code> y <code>"1952"</code>.
Como el año tiene siempre 4 caracteres, una solución simple es usar <code>sep = -4</code>, que significa que la separación es 4 caracteres contando desde el final.</p>
<p>Habrás notado un problema.
El texto en la columnas <code>variable</code> todavía tiene un “_” al final.
Podrías usar <code>mutate()</code> y un poco de funciones de manipulación de caracteres para quitarlo, pero hay una forma un poco más simple y es separando la columna <code>variable_anio</code> en tres, incluyendo una columna con el guión:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb147-1" aria-hidden="true" tabindex="-1"></a>paises_largo <span class="ot">&lt;-</span> <span class="fu">separate</span>(paises_largo, </span>
<span id="cb147-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb147-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> variable_anio, </span>
<span id="cb147-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb147-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;guion&quot;</span>, <span class="st">&quot;anio&quot;</span>), </span>
<span id="cb147-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb147-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sep =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">4</span>))</span>
<span id="cb147-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb147-5" aria-hidden="true" tabindex="-1"></a>paises_largo</span></code></pre></div>
<pre><code>## # A tibble: 5,112 × 6
##    continente pais    variable  guion anio     valor
##    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;
##  1 Africa     Algeria poblacion _     1952   9279525
##  2 Africa     Algeria poblacion _     1957  10270856
##  3 Africa     Algeria poblacion _     1962  11000948
##  4 Africa     Algeria poblacion _     1967  12760499
##  5 Africa     Algeria poblacion _     1972  14760787
##  6 Africa     Algeria poblacion _     1977  17152804
##  7 Africa     Algeria poblacion _     1982  20033753
##  8 Africa     Algeria poblacion _     1987  23254956
##  9 Africa     Algeria poblacion _     1992  26298373
## 10 Africa     Algeria poblacion _     1997  29072015
## # … with 5,102 more rows</code></pre>
<p>Y ya casi.
Hay que eliminar la columna <code>guion</code>, que no sirve para nada.
Pero fijate que debajo de la columna <code>anio</code> dice <code>&lt;chr&gt;</code>; eso significa que el tipo de la columna es caracter, pero los años son números.
Usando <code>mutate()</code> podés eliminar la columna <code>guion</code> asignándole el valor <code>NULL</code> (nulo) y coercer (recordá <a href="04-lectura-datos.html#Vectores">esta sección</a>) la columna <code>anio</code> a entero usando <code>as.integer()</code>:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb149-1" aria-hidden="true" tabindex="-1"></a>paises_largo <span class="ot">&lt;-</span> <span class="fu">mutate</span>(paises_largo, </span>
<span id="cb149-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb149-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guion =</span> <span class="cn">NULL</span>,</span>
<span id="cb149-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb149-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">anio =</span> <span class="fu">as.integer</span>(anio))</span>
<span id="cb149-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb149-4" aria-hidden="true" tabindex="-1"></a>paises_largo</span></code></pre></div>
<pre><code>## # A tibble: 5,112 × 5
##    continente pais    variable   anio    valor
##    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;int&gt;    &lt;dbl&gt;
##  1 Africa     Algeria poblacion  1952  9279525
##  2 Africa     Algeria poblacion  1957 10270856
##  3 Africa     Algeria poblacion  1962 11000948
##  4 Africa     Algeria poblacion  1967 12760499
##  5 Africa     Algeria poblacion  1972 14760787
##  6 Africa     Algeria poblacion  1977 17152804
##  7 Africa     Algeria poblacion  1982 20033753
##  8 Africa     Algeria poblacion  1987 23254956
##  9 Africa     Algeria poblacion  1992 26298373
## 10 Africa     Algeria poblacion  1997 29072015
## # … with 5,102 more rows</code></pre>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>Juntá todos los pasos anteriores en una sola cadena de operaciones usando <code>%&gt;%</code>.</p>
</div>
</div>
<div id="de-largo-a-ancho-con-pivot_wider" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> De largo a ancho con <code>pivot_wider()</code></h2>
<p>Ahora la variable <code>paises_largo</code> está en el formato más largo posible.
Tiene 5 columnas, de las cuales sólo una es la columnas con valores.
Pero con los datos así no podrías hacer un gráfico de puntos que muestre la relación entre el PBI per cápita y la expectativa de vida como en la <a href="06-graficos-I.html#Segunda_capa:_geometrías">sección de gráficos</a>.
Fijate que los valores de la columna <code>valor</code> no tienen todos las mismas unidades, por lo que operar con ese vector podría dar resultados sin sentido.
Muchas veces es conveniente y natural tener los datos en un formato intermedio en donde hay múltiples columnas con los valores de distintas variables observadas.</p>
<p>Pasa “ensanchar” una tabla está la función <code>pivot_wider()</code> (“wider” es “más ancha” en inglés) y el código para conseguir este formato intermedio es:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb151-1" aria-hidden="true" tabindex="-1"></a>paises_medio <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(paises_largo, <span class="at">names_from =</span> variable, <span class="at">values_from =</span> valor)</span>
<span id="cb151-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb151-2" aria-hidden="true" tabindex="-1"></a>paises_medio</span></code></pre></div>
<pre><code>## # A tibble: 1,704 × 6
##    continente pais     anio poblacion esperanza_de_vi… pib_per_capita
##    &lt;chr&gt;      &lt;chr&gt;   &lt;int&gt;     &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;
##  1 Africa     Algeria  1952   9279525             43.1          2449.
##  2 Africa     Algeria  1957  10270856             45.7          3014.
##  3 Africa     Algeria  1962  11000948             48.3          2551.
##  4 Africa     Algeria  1967  12760499             51.4          3247.
##  5 Africa     Algeria  1972  14760787             54.5          4183.
##  6 Africa     Algeria  1977  17152804             58.0          4910.
##  7 Africa     Algeria  1982  20033753             61.4          5745.
##  8 Africa     Algeria  1987  23254956             65.8          5681.
##  9 Africa     Algeria  1992  26298373             67.7          5023.
## 10 Africa     Algeria  1997  29072015             69.2          4797.
## # … with 1,694 more rows</code></pre>
<p>Nuevamente el primer argumento es la tabla original.
El segundo, <code>names_from</code> es la columna cuyos valores únicos van a convertirse en nuevas columnas.
La columna <code>variable</code> tiene los valores <code>"población"</code>, <code>"esperanza_de_vida"</code> y <code>"pib_per_capita"</code> y entonces la tabla nueva tendrá tres columnas con esos nombres.
El tercer argumento, <code>values_from</code>, es la columna de la cual sacar los valores.</p>
<p>Para volver al formato más ancho, basta con agregar más columnas en el argumento <code>names_from</code>:</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(paises_largo, </span>
<span id="cb153-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb153-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">names_from =</span> <span class="fu">c</span>(variable, anio), </span>
<span id="cb153-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb153-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>,</span>
<span id="cb153-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb153-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">values_from =</span> valor)</span></code></pre></div>
<pre><code>## # A tibble: 142 × 38
##    continente pais       poblacion_1952 poblacion_1957 poblacion_1962
##    &lt;chr&gt;      &lt;chr&gt;               &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
##  1 Africa     Algeria           9279525       10270856       11000948
##  2 Africa     Angola            4232095        4561361        4826015
##  3 Africa     Benin             1738315        1925173        2151895
##  4 Africa     Botswana           442308         474639         512764
##  5 Africa     Burkina F…        4469979        4713416        4919632
##  6 Africa     Burundi           2445618        2667518        2961915
##  7 Africa     Cameroon          5009067        5359923        5793633
##  8 Africa     Central A…        1291695        1392284        1523478
##  9 Africa     Chad              2682462        2894855        3150417
## 10 Africa     Comoros            153936         170928         191689
## # … with 132 more rows, and 33 more variables: poblacion_1967 &lt;dbl&gt;,
## #   poblacion_1972 &lt;dbl&gt;, poblacion_1977 &lt;dbl&gt;,
## #   poblacion_1982 &lt;dbl&gt;, poblacion_1987 &lt;dbl&gt;,
## #   poblacion_1992 &lt;dbl&gt;, poblacion_1997 &lt;dbl&gt;,
## #   poblacion_2002 &lt;dbl&gt;, poblacion_2007 &lt;dbl&gt;,
## #   esperanza_de_vida_1952 &lt;dbl&gt;, esperanza_de_vida_1957 &lt;dbl&gt;,
## #   esperanza_de_vida_1962 &lt;dbl&gt;, esperanza_de_vida_1967 &lt;dbl&gt;, …</code></pre>
<p>En esta llamada también está el argumento <code>names_sep</code>, que determina el caracter que se usa para crear el nombre de las nuevas columnas.</p>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<ul>
<li><p>Creá una nueva tabla, llamada <code>paises_superduper_ancho</code> que tenga una columna para cada variable, anio y país.
(Consejo: la tabla final tiene que tener 5 filas).</p></li>
<li><p>¿Cómo es la tabla más ancha posible que podés generar con estos datos?
¿Cuántas filas y columnas tiene?</p></li>
</ul>
</div>
</div>
<div id="uniendo-tablas" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Uniendo tablas</h2>
<p>Hasta ahora todo lo que usaste de {dplyr} involucra trabajar y modificar con una sola tabla a la vez, pero es muy común tener dos o más tablas con datos relacionados.
En ese caso, tenemos que <em>unir</em> estas tablas.
a partir de una o más variables en común o <em>keys</em>.
En Excel u otro programa de hojas de cálculo, esto se resuelve con la función “VLOOKUP” o “BUSCARV”, en R y en particular dentro del mundo de {dplyr} hay que usar la familia de funciones <code>*_join()</code>.
Hay una función cada tipo de unión que queramos hacer.</p>
<p>Asumiendo que querés unir dos data.frames o tablas <code>x</code> e <code>y</code> que tienen en común una variable <code>A</code>:</p>
<p><img src="img/join.png" /></p>
<ul>
<li><p><code>full_join()</code>: devuelve todas las filas y todas las columnas de ambas tablas <code>x</code> e <code>y</code>.
Cuando no coinciden los elementos en <code>x1</code>, devuelve <code>NA</code> (dato faltante).
Esto significa que no se pierden filas de ninguna de las dos tablas aún cuando no hay coincidencia.
Está es la manera más segura de unir tablas.</p></li>
<li><p><code>left_join()</code>: devuelve todas las filas de <code>x</code> y todas las columnas de <code>x</code> e <code>y</code>.
Las filas en <code>x</code> que no tengan coincidencia con <code>y</code> tendrán <code>NA</code> en las nuevas columnas.
Si hay múltiples coincidencias entre <code>x</code>e <code>y</code>, devuelve todas las coincidencias posibles.</p></li>
<li><p><code>right_join()</code>: es igual que <code>left_join()</code> pero intercambiando el orden de <code>x</code> e <code>y</code>.
En otras palabras, <code>right_join(x, y)</code> es idéntico a <code>left_join(y, x)</code>.</p></li>
<li><p><code>inner_join()</code>: devuelve todas las filas de <code>x</code> donde hay coincidencias con <code>y</code> y todas las columnas de <code>x</code> e <code>y</code>.
Si hay múltiples coincidencias entre <code>x</code> e <code>y</code>, entonces devuelve todas las coincidencias.
Esto significa que eliminará las filas (observaciones) que no coincidan en ambas tablas, lo que puede ser peligroso.</p></li>
</ul>
<p><img src="img/join_family.png" /></p>
<p>Ahora vamos a seguir trabajando con las base de datos de <code>paises</code> pero nos vamos a quedar solo con las observaciones del 2007 y de paso unirlo a una nueva base de datos <code>co2</code> que contiene información de la emisión de dióxido de carbono de cada país para ese mismo año.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb155-1" aria-hidden="true" tabindex="-1"></a>paises_2007 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;datos/paises.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb155-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) </span>
<span id="cb155-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb155-4" aria-hidden="true" tabindex="-1"></a>co2_2007 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;datos/co2_2007.csv&quot;</span>)</span>
<span id="cb155-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb155-5" aria-hidden="true" tabindex="-1"></a>co2_2007</span></code></pre></div>
<pre><code>## # A tibble: 218 × 3
##    codigo_iso emision_co2 pais                  
##    &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;                 
##  1 ABW            27.9    Aruba                 
##  2 AFG             0.0854 Afghanistán           
##  3 AGO             1.20   Angola                
##  4 ALB             1.32   Albania               
##  5 AND             6.52   Andorra               
##  6 ARB             4.10   Mundo Árabe           
##  7 ARE            22.4    Emiratos Árabes Unidos
##  8 ARG             4.38   Argentina             
##  9 ARM             1.73   Armenia               
## 10 ATG             5.14   Antigua y Barbuda     
## # … with 208 more rows</code></pre>
<p>Esta nueva tabla tiene 3 columnas: <code>codigo_iso</code> tiene el código ISO de 3 letras de (abreviaturas que se usan internacionalmente), <code>emision_co2</code> tiene las emisiones anuales per cápita de CO2 en toneladas, <code>pais</code> tiene el nombre del país.
Esta última columna también está presente en la tabla <code>paises_2007</code> y es la que va a servir como variable llave para unir las dos tablas.</p>
<p>Para unir las dos tablas, cualquier función <em>join</em> requiere cierta información:</p>
<ul>
<li>las tablas a unir: son los dos primeros argumentos.</li>
<li>qué variable o variables (se puede usar más de una!) usar para identificar coincidencias: el argumento <code>by</code>.</li>
</ul>
<p>Unamos <code>paises_2007</code> y <code>co2_2007</code> primero con <code>full_join()</code>:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb157-1" aria-hidden="true" tabindex="-1"></a>paises_co2_2007 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(paises_2007, co2_2007, <span class="at">by =</span> <span class="st">&quot;pais&quot;</span>)</span>
<span id="cb157-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb157-2" aria-hidden="true" tabindex="-1"></a>paises_co2_2007</span></code></pre></div>
<pre><code>## # A tibble: 241 × 8
##    pais       continente  anio esperanza_de_vida poblacion pib_per_capita
##    &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;             &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;
##  1 Afganistán Asia        2007              43.8  31889923           975.
##  2 Albania    Europa      2007              76.4   3600523          5937.
##  3 Argelia    África      2007              72.3  33333216          6223.
##  4 Angola     África      2007              42.7  12420476          4797.
##  5 Argentina  Américas    2007              75.3  40301927         12779.
##  6 Australia  Oceanía     2007              81.2  20434176         34435.
##  7 Austria    Europa      2007              79.8   8199783         36126.
##  8 Baréin     Asia        2007              75.6    708573         29796.
##  9 Bangladesh Asia        2007              64.1 150448339          1391.
## 10 Bélgica    Europa      2007              79.4  10392226         33693.
## # … with 231 more rows, and 2 more variables: codigo_iso &lt;chr&gt;,
## #   emision_co2 &lt;dbl&gt;</code></pre>
<p>Si miramos de cerca la tabla unida veremos un par de cosas:</p>
<ul>
<li>Todas las columnas de <code>paises_2007</code> y de <code>co2_2007</code> están presentes.</li>
<li>Todas las observaciones están presentes, aún los países que están presentes en <code>co2_2007</code> pero no en <code>paises_2007</code> y viceversa. En esos casos ahora tenemos <code>NA</code>. Esto genera una tabla con 241 filas.</li>
</ul>
<p>Esta es la opción más segura si no sabemos si todas las observaciones de una tabla están presente en a otra.</p>
<p>Si solo nos interesa conservar las filas de la tabla <em>de la izquierda</em>, en este caso <code>paises_2007</code> entonces:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb159-1" aria-hidden="true" tabindex="-1"></a>paises_co2_2007 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(paises_2007, co2_2007, <span class="at">by =</span> <span class="st">&quot;pais&quot;</span>)</span>
<span id="cb159-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb159-2" aria-hidden="true" tabindex="-1"></a>paises_co2_2007</span></code></pre></div>
<pre><code>## # A tibble: 142 × 8
##    pais       continente  anio esperanza_de_vida poblacion pib_per_capita
##    &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;             &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;
##  1 Afganistán Asia        2007              43.8  31889923           975.
##  2 Albania    Europa      2007              76.4   3600523          5937.
##  3 Argelia    África      2007              72.3  33333216          6223.
##  4 Angola     África      2007              42.7  12420476          4797.
##  5 Argentina  Américas    2007              75.3  40301927         12779.
##  6 Australia  Oceanía     2007              81.2  20434176         34435.
##  7 Austria    Europa      2007              79.8   8199783         36126.
##  8 Baréin     Asia        2007              75.6    708573         29796.
##  9 Bangladesh Asia        2007              64.1 150448339          1391.
## 10 Bélgica    Europa      2007              79.4  10392226         33693.
## # … with 132 more rows, and 2 more variables: codigo_iso &lt;chr&gt;,
## #   emision_co2 &lt;dbl&gt;</code></pre>
<p>Ahora esperamos que la tabla resultante tenga la misma cantidad de filas que <code>paises_2007</code> y efectivamente eso ocurre.
Pero al mismo tiempo varios países en esa tabla no encontraron coincidencia en <code>co2_2007</code> y por esa razón, la columna nueva columna <code>emisiones_co2</code> tiene <code>NA</code>.</p>
<p>Finalmente, si quisiéramos quedarnos solo con las observaciones que están presentes en ambas tablas usamos <code>inner_join()</code>.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb161-1" aria-hidden="true" tabindex="-1"></a>paises_co2_2007 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(paises_2007, co2_2007, <span class="at">by =</span> <span class="st">&quot;pais&quot;</span>)</span>
<span id="cb161-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb161-2" aria-hidden="true" tabindex="-1"></a>paises_co2_2007</span></code></pre></div>
<pre><code>## # A tibble: 119 × 8
##    pais    continente  anio esperanza_de_vi… poblacion pib_per_capita
##    &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;            &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;
##  1 Albania Europa      2007             76.4   3600523          5937.
##  2 Angola  África      2007             42.7  12420476          4797.
##  3 Argent… Américas    2007             75.3  40301927         12779.
##  4 Austra… Oceanía     2007             81.2  20434176         34435.
##  5 Austria Europa      2007             79.8   8199783         36126.
##  6 Bangla… Asia        2007             64.1 150448339          1391.
##  7 Bélgica Europa      2007             79.4  10392226         33693.
##  8 Bolivia Américas    2007             65.6   9119152          3822.
##  9 Bosnia… Europa      2007             74.9   4552198          7446.
## 10 Botswa… África      2007             50.7   1639131         12570.
## # … with 109 more rows, and 2 more variables: codigo_iso &lt;chr&gt;,
## #   emision_co2 &lt;dbl&gt;</code></pre>
<p>En este caso, perdemos las filas de <code>co2_2007</code> que no encontraron coincidencia en <code>paises_2007</code> y viceversa y la tabla resultante tiene aún menos filas (119).</p>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>Estuvimos trabajando con una parte de la base de datos de emisiones.
Pero también está disponible <code>co2_completo.csv</code> que contiene las emisiones para distintos años.
El objetivo es que unas <code>paises</code> y <code>co2</code> teniendo en cuenta tanto el país como el año.
Para eso:</p>
<ol style="list-style-type: decimal">
<li>Lee la base de datos <code>co2_completo.csv</code> en una nueva variable que se llame <code>co2</code>.</li>
<li>Revisá el nombre de las variables en esta base de datos, ¿se llaman igual que las variables en <code>paises</code>?</li>
<li>Uní las dos tablas usando <code>full_join()</code>, tené en cuenta que ahora usamos dos variables llave <code>pais</code> y <code>anio</code>. Buscá en la documentación cómo indicarle eso a la función <code>full_join()</code>.<br />
</li>
</ol>
</div>

</div>
<div id="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii-1" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Manipulación de datos ordenados usando {dplyr} y {tidyr} II</h2>
<p>En <a href="04-lectura-datos.html#Formatos_de_tablas">la última sección de lectura de datos</a> viste el concepto de datos “anchos” y “largos”.</p>
<p>Los datos en formato “largo” o “tidy”, son aquellos en los cuales:</p>
<ul>
<li>cada fila es una observación</li>
<li>cada columna es una variable</li>
</ul>
<p>En el formato “ancho” es un poco más complejo de definirlo pero la idea general es que:</p>
<ul>
<li>cada fila es un “item”</li>
<li>cada columna es una variable</li>
</ul>
<p><img src="img/largo-ancho.png" /></p>
<p>Una tabla en formato largo va a tener una cierta cantidad de columnas que cumplen el rol de <em>identificadores</em> y cuya combinación identifican una única observación y una única columna con el valor de la observación.
En el ejemplo de arriba, <code>pais</code> y <code>anio</code> son las columnas identificadoras y <code>casos</code> es la columna que contiene el valor de las observaciones.</p>
<p>En una tabla ancha, cada observación única se identifica a partir de la intersección de filas y columnas.
En el ejemplo, los países están en las filas y los años en las columnas.</p>
<p>En general, el formato ancho es más compacto y legible por humanos mientras que el largo es más fácil de manejar con la computadora.
Si te fijás en las tablas de arriba, es más fácil comparar los valores entre países y entre años en la tabla ancha.
Pero el nombre de las columnas (“1999”, “2000”) en realidad ¡son datos!
Además este formato se empieza a complicar en cuanto hay más de dos identificadores.</p>
<p>Un mismo set de datos puede ser representado de forma completamente “larga”, completamente “ancha” o –lo que es más común– en un formato intermedio pero no existe una forma “correcta” de organizar los datos; cada una tiene sus ventajas y desventajas.
Por esto es que es muy normal que durante un análisis los datos vayan y vuelvan entre distintos formatos dependiendo de los métodos estadísticos que se le aplican.
Entonces, aprender a transformar datos anchos en largos y viceversa es un habilidad muy útil.</p>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>En las tablas de ejemplo cada país tiene el un valor observado de “casos” para cada año.
¿Cómo agregarías una nueva variable con información sobre “precios”?
Dibujá un esquema en papel y lápiz en formato ancho y uno en formato largo.
¿En qué formato es más “natural” esa extensión?</p>
</div>
<p>En esta sección vas a usar el paquete {tidyr} para manipular datos.
Si no lo tenés instalado, instalalo con el comando:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyr&quot;</span>)</span></code></pre></div>
<p>(como siempre, recordá que esto hay que hacerlo una única vez)</p>
<p>Y luego cargá {tidyr} y {dplyr} (que usaste en <a href="05-dplyr-I.html">una sección anterior</a>) con:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb164-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
</div>
<div id="de-ancho-a-largo-con-pivot_longer-1" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> De ancho a largo con <code>pivot_longer()</code></h2>
<p>En secciones anteriores usaste una versión de los datos de <a href="https://www.gapminder.org/">gapminder</a>.
Ahora vas a leer los datos en su formato original:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb165-1" aria-hidden="true" tabindex="-1"></a>paises_ancho <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;datos/paises_ancho.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 142 Columns: 38</code></pre>
<pre><code>## ── Column specification ─────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (2): continente, pais
## dbl (36): pib_per_capita_1952, pib_per_capita_1957, pib_per_capit...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb169-1" aria-hidden="true" tabindex="-1"></a>paises_ancho</span></code></pre></div>
<pre><code>## # A tibble: 142 × 38
##    continente pais                     pib_per_capita_… pib_per_capita_…
##    &lt;chr&gt;      &lt;chr&gt;                               &lt;dbl&gt;            &lt;dbl&gt;
##  1 Africa     Algeria                             2449.            3014.
##  2 Africa     Angola                              3521.            3828.
##  3 Africa     Benin                               1063.             960.
##  4 Africa     Botswana                             851.             918.
##  5 Africa     Burkina Faso                         543.             617.
##  6 Africa     Burundi                              339.             380.
##  7 Africa     Cameroon                            1173.            1313.
##  8 Africa     Central African Republic            1071.            1191.
##  9 Africa     Chad                                1179.            1308.
## 10 Africa     Comoros                             1103.            1211.
## # … with 132 more rows, and 34 more variables:
## #   pib_per_capita_1962 &lt;dbl&gt;, pib_per_capita_1967 &lt;dbl&gt;,
## #   pib_per_capita_1972 &lt;dbl&gt;, pib_per_capita_1977 &lt;dbl&gt;,
## #   pib_per_capita_1982 &lt;dbl&gt;, pib_per_capita_1987 &lt;dbl&gt;,
## #   pib_per_capita_1992 &lt;dbl&gt;, pib_per_capita_1997 &lt;dbl&gt;,
## #   pib_per_capita_2002 &lt;dbl&gt;, pib_per_capita_2007 &lt;dbl&gt;,
## #   esperanza_de_vida_1952 &lt;dbl&gt;, esperanza_de_vida_1957 &lt;dbl&gt;, …</code></pre>
<div class="alert alert-success">
<p>¿Notaste que en el código anterior no usaste <code>library(readr)</code> para cargar el paquete y luego leer?
Con la notación <code>paquete::funcion()</code> podés acceder a las funciones de un paquete sin tener que cargarlo.
Es una buena forma de no tener que cargar un montón de paquetes innecesarios si vas a correr una única función de un paquete pocas veces.</p>
</div>
<p>Esta tabla, increíblemente ancha, es muy difícil de manejar.
Por ejemplo, es imposible hacer una serie de tiempo de una variable, o calcular el promedio por variable y país; ni hablar de calcular una regresión lineal.</p>
<p>Para convertirlo en una tabla más larga, se usa <code>pivot_longer()</code> (“longer” es “más largo” en inglés):</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb171-1" aria-hidden="true" tabindex="-1"></a>paises_largo <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(paises_ancho,</span>
<span id="cb171-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb171-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">cols =</span> <span class="fu">c</span>(<span class="fu">starts_with</span>(<span class="st">&#39;pob&#39;</span>), </span>
<span id="cb171-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb171-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">starts_with</span>(<span class="st">&#39;esperanza&#39;</span>), </span>
<span id="cb171-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb171-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">starts_with</span>(<span class="st">&#39;pib_per&#39;</span>)),</span>
<span id="cb171-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb171-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">names_to =</span> <span class="st">&quot;variable_anio&quot;</span>, </span>
<span id="cb171-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb171-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">values_to =</span> <span class="st">&quot;valor&quot;</span></span>
<span id="cb171-7"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb171-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb171-8"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb171-8" aria-hidden="true" tabindex="-1"></a>paises_largo</span></code></pre></div>
<pre><code>## # A tibble: 5,112 × 4
##    continente pais    variable_anio     valor
##    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;             &lt;dbl&gt;
##  1 Africa     Algeria poblacion_1952  9279525
##  2 Africa     Algeria poblacion_1957 10270856
##  3 Africa     Algeria poblacion_1962 11000948
##  4 Africa     Algeria poblacion_1967 12760499
##  5 Africa     Algeria poblacion_1972 14760787
##  6 Africa     Algeria poblacion_1977 17152804
##  7 Africa     Algeria poblacion_1982 20033753
##  8 Africa     Algeria poblacion_1987 23254956
##  9 Africa     Algeria poblacion_1992 26298373
## 10 Africa     Algeria poblacion_1997 29072015
## # … with 5,102 more rows</code></pre>
<p>El primer argumento de<code>pivot_longer()</code> es la tabla que va a modificar: <code>paises_ancho</code>.
El segundo argumento se llama <code>cols</code> y es un vector con las columnas que tienen los valores a “alargar”.
Podría ser un vector escrito a mano (algo como <code>c("pib_per_capita_1952", "pib_per_capita_1957"...)</code>) pero con más de 30 columnas, escribir todo eso sería tedioso y probablemente estaría lleno de errores.
Por eso {tidyr} provee funciones de ayuda para seleccionar columnas en base a patrones.
El código de arriba usa <code>starts_with()</code> que, como su nombre en inglés lo indica, selecciona las columnas que <em>empiezan con</em> una determinada cadena de caracteres.
El vector <code>c(starts_with('pob'), starts_with('esperanza'), starts_with('pib_per'))</code> le dice a <code>pivot_longer()</code> que seleccione las columnas que empieza con “pob”, las que empiezan con “esperanza” y las que empiezan con “pib_per”.</p>
<div class="alert alert-success">
<p>Estas funciones accesorias para seleccionar muchas funciones se llaman “tidyselect”.
Si querés leer más detalles de las distintas formas que podés seleccionar variables leé la documentación usando <code>?tidyselect::language</code>.</p>
</div>
<p>El tercer y cuarto argumento son los nombres de las columnas de “nombre” y de “valor” que va a tener la nueva tabla.
Como la nueva columna de identificación tiene los datos de la variable y el año a medir, “variable_anio” es un buen nombre.
Y la columna de valor va a tener… bueno, el valor.</p>
<p>Tomate un momento para visualizar lo que acaba de pasar.
La tabla ancha tenía un montón de columnas con distintos datos.
Ahora estos datos están uno arriba de otro en la columna “valor”, pero para identificar el nombre de la columna de la cual vinieron, se agrega la columna “variable_anio”.</p>
<div class="figure">
<img src="img/ancho-a-largo.png" alt="" />
<p class="caption">Proceso de largo a ancho</p>
</div>
<p>La columna <code>variable_anio</code> todavía no es muy útil porque contiene 2 datos, la variable (población, expectativa de vida o PBI per cápita) y el año.
Sería mejor separar esta información en dos columnas llamadas “variable” y “anio”.
Para eso está la función <code>separate()</code>.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(paises_largo, </span>
<span id="cb173-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb173-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> variable_anio, </span>
<span id="cb173-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb173-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;anio&quot;</span>), </span>
<span id="cb173-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb173-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sep =</span> <span class="sc">-</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5,112 × 5
##    continente pais    variable   anio     valor
##    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
##  1 Africa     Algeria poblacion_ 1952   9279525
##  2 Africa     Algeria poblacion_ 1957  10270856
##  3 Africa     Algeria poblacion_ 1962  11000948
##  4 Africa     Algeria poblacion_ 1967  12760499
##  5 Africa     Algeria poblacion_ 1972  14760787
##  6 Africa     Algeria poblacion_ 1977  17152804
##  7 Africa     Algeria poblacion_ 1982  20033753
##  8 Africa     Algeria poblacion_ 1987  23254956
##  9 Africa     Algeria poblacion_ 1992  26298373
## 10 Africa     Algeria poblacion_ 1997  29072015
## # … with 5,102 more rows</code></pre>
<p>El primer argumento, como siempre, es la tabla a procesar.
El segundo, <code>col</code>, es la columna a separar en dos (o más) columnas nuevas.
El tercero, <code>into</code> es el nombre de las nuevas columnas que <code>separate()</code> va a crear.
El último argumento es <code>sep</code> que define cómo realizar la separación.
Por defecto, <code>sep</code> es una <a href="https://es.wikipedia.org/wiki/Expresi%C3%B3n_regular">expresión regular</a> que captura cualquier caracter no alfanumérico.
En el caso de <code>variable_anio</code> no sirve, porque para valores como <code>"esperanza_de_vida_1952"</code>, separaría en <code>"esperanza"</code>, <code>"de"</code>, <code>"vida"</code> y <code>"1952"</code>.
Como el año tiene siempre 4 caracteres, una solución simple es usar <code>sep = -4</code>, que significa que la separación es 4 caracteres contando desde el final.</p>
<p>Habrás notado un problema.
El texto en la columnas <code>variable</code> todavía tiene un “_” al final.
Podrías usar <code>mutate()</code> y un poco de funciones de manipulación de caracteres para quitarlo, pero hay una forma un poco más simple y es separando la columna <code>variable_anio</code> en tres, incluyendo una columna con el guión:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb175-1" aria-hidden="true" tabindex="-1"></a>paises_largo <span class="ot">&lt;-</span> <span class="fu">separate</span>(paises_largo, </span>
<span id="cb175-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb175-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> variable_anio, </span>
<span id="cb175-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb175-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;guion&quot;</span>, <span class="st">&quot;anio&quot;</span>), </span>
<span id="cb175-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb175-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sep =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">4</span>))</span>
<span id="cb175-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb175-5" aria-hidden="true" tabindex="-1"></a>paises_largo</span></code></pre></div>
<pre><code>## # A tibble: 5,112 × 6
##    continente pais    variable  guion anio     valor
##    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;
##  1 Africa     Algeria poblacion _     1952   9279525
##  2 Africa     Algeria poblacion _     1957  10270856
##  3 Africa     Algeria poblacion _     1962  11000948
##  4 Africa     Algeria poblacion _     1967  12760499
##  5 Africa     Algeria poblacion _     1972  14760787
##  6 Africa     Algeria poblacion _     1977  17152804
##  7 Africa     Algeria poblacion _     1982  20033753
##  8 Africa     Algeria poblacion _     1987  23254956
##  9 Africa     Algeria poblacion _     1992  26298373
## 10 Africa     Algeria poblacion _     1997  29072015
## # … with 5,102 more rows</code></pre>
<p>Y ya casi.
Hay que eliminar la columna <code>guion</code>, que no sirve para nada.
Pero fijate que debajo de la columna <code>anio</code> dice <code>&lt;chr&gt;</code>; eso significa que el tipo de la columna es caracter, pero los años son números.
Usando <code>mutate()</code> podés eliminar la columna <code>guion</code> asignándole el valor <code>NULL</code> (nulo) y coercer (recordá <a href="04-lectura-datos.html#Vectores">esta sección</a>) la columna <code>anio</code> a entero usando <code>as.integer()</code>:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb177-1" aria-hidden="true" tabindex="-1"></a>paises_largo <span class="ot">&lt;-</span> <span class="fu">mutate</span>(paises_largo, </span>
<span id="cb177-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb177-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">guion =</span> <span class="cn">NULL</span>,</span>
<span id="cb177-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb177-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">anio =</span> <span class="fu">as.integer</span>(anio))</span>
<span id="cb177-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb177-4" aria-hidden="true" tabindex="-1"></a>paises_largo</span></code></pre></div>
<pre><code>## # A tibble: 5,112 × 5
##    continente pais    variable   anio    valor
##    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;     &lt;int&gt;    &lt;dbl&gt;
##  1 Africa     Algeria poblacion  1952  9279525
##  2 Africa     Algeria poblacion  1957 10270856
##  3 Africa     Algeria poblacion  1962 11000948
##  4 Africa     Algeria poblacion  1967 12760499
##  5 Africa     Algeria poblacion  1972 14760787
##  6 Africa     Algeria poblacion  1977 17152804
##  7 Africa     Algeria poblacion  1982 20033753
##  8 Africa     Algeria poblacion  1987 23254956
##  9 Africa     Algeria poblacion  1992 26298373
## 10 Africa     Algeria poblacion  1997 29072015
## # … with 5,102 more rows</code></pre>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>Juntá todos los pasos anteriores en una sola cadena de operaciones usando <code>%&gt;%</code>.</p>
</div>
</div>
<div id="de-largo-a-ancho-con-pivot_wider-1" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> De largo a ancho con <code>pivot_wider()</code></h2>
<p>Ahora la variable <code>paises_largo</code> está en el formato más largo posible.
Tiene 5 columnas, de las cuales sólo una es la columnas con valores.
Pero con los datos así no podrías hacer un gráfico de puntos que muestre la relación entre el PBI per cápita y la expectativa de vida como en la <a href="06-graficos-I.html#Segunda_capa:_geometrías">sección de gráficos</a>.
Fijate que los valores de la columna <code>valor</code> no tienen todos las mismas unidades, por lo que operar con ese vector podría dar resultados sin sentido.
Muchas veces es conveniente y natural tener los datos en un formato intermedio en donde hay múltiples columnas con los valores de distintas variables observadas.</p>
<p>Pasa “ensanchar” una tabla está la función <code>pivot_wider()</code> (“wider” es “más ancha” en inglés) y el código para conseguir este formato intermedio es:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb179-1" aria-hidden="true" tabindex="-1"></a>paises_medio <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(paises_largo, <span class="at">names_from =</span> variable, <span class="at">values_from =</span> valor)</span>
<span id="cb179-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb179-2" aria-hidden="true" tabindex="-1"></a>paises_medio</span></code></pre></div>
<pre><code>## # A tibble: 1,704 × 6
##    continente pais     anio poblacion esperanza_de_vi… pib_per_capita
##    &lt;chr&gt;      &lt;chr&gt;   &lt;int&gt;     &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;
##  1 Africa     Algeria  1952   9279525             43.1          2449.
##  2 Africa     Algeria  1957  10270856             45.7          3014.
##  3 Africa     Algeria  1962  11000948             48.3          2551.
##  4 Africa     Algeria  1967  12760499             51.4          3247.
##  5 Africa     Algeria  1972  14760787             54.5          4183.
##  6 Africa     Algeria  1977  17152804             58.0          4910.
##  7 Africa     Algeria  1982  20033753             61.4          5745.
##  8 Africa     Algeria  1987  23254956             65.8          5681.
##  9 Africa     Algeria  1992  26298373             67.7          5023.
## 10 Africa     Algeria  1997  29072015             69.2          4797.
## # … with 1,694 more rows</code></pre>
<p>Nuevamente el primer argumento es la tabla original.
El segundo, <code>names_from</code> es la columna cuyos valores únicos van a convertirse en nuevas columnas.
La columna <code>variable</code> tiene los valores <code>"población"</code>, <code>"esperanza_de_vida"</code> y <code>"pib_per_capita"</code> y entonces la tabla nueva tendrá tres columnas con esos nombres.
El tercer argumento, <code>values_from</code>, es la columna de la cual sacar los valores.</p>
<p>Para volver al formato más ancho, basta con agregar más columnas en el argumento <code>names_from</code>:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(paises_largo, </span>
<span id="cb181-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb181-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">names_from =</span> <span class="fu">c</span>(variable, anio), </span>
<span id="cb181-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb181-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>,</span>
<span id="cb181-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb181-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">values_from =</span> valor)</span></code></pre></div>
<pre><code>## # A tibble: 142 × 38
##    continente pais       poblacion_1952 poblacion_1957 poblacion_1962
##    &lt;chr&gt;      &lt;chr&gt;               &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
##  1 Africa     Algeria           9279525       10270856       11000948
##  2 Africa     Angola            4232095        4561361        4826015
##  3 Africa     Benin             1738315        1925173        2151895
##  4 Africa     Botswana           442308         474639         512764
##  5 Africa     Burkina F…        4469979        4713416        4919632
##  6 Africa     Burundi           2445618        2667518        2961915
##  7 Africa     Cameroon          5009067        5359923        5793633
##  8 Africa     Central A…        1291695        1392284        1523478
##  9 Africa     Chad              2682462        2894855        3150417
## 10 Africa     Comoros            153936         170928         191689
## # … with 132 more rows, and 33 more variables: poblacion_1967 &lt;dbl&gt;,
## #   poblacion_1972 &lt;dbl&gt;, poblacion_1977 &lt;dbl&gt;,
## #   poblacion_1982 &lt;dbl&gt;, poblacion_1987 &lt;dbl&gt;,
## #   poblacion_1992 &lt;dbl&gt;, poblacion_1997 &lt;dbl&gt;,
## #   poblacion_2002 &lt;dbl&gt;, poblacion_2007 &lt;dbl&gt;,
## #   esperanza_de_vida_1952 &lt;dbl&gt;, esperanza_de_vida_1957 &lt;dbl&gt;,
## #   esperanza_de_vida_1962 &lt;dbl&gt;, esperanza_de_vida_1967 &lt;dbl&gt;, …</code></pre>
<p>En esta llamada también está el argumento <code>names_sep</code>, que determina el caracter que se usa para crear el nombre de las nuevas columnas.</p>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<ul>
<li><p>Creá una nueva tabla, llamada <code>paises_superduper_ancho</code> que tenga una columna para cada variable, anio y país.
(Consejo: la tabla final tiene que tener 5 filas).</p></li>
<li><p>¿Cómo es la tabla más ancha posible que podés generar con estos datos?
¿Cuántas filas y columnas tiene?</p></li>
</ul>
</div>
</div>
<div id="uniendo-tablas-1" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Uniendo tablas</h2>
<p>Hasta ahora todo lo que usaste de {dplyr} involucra trabajar y modificar con una sola tabla a la vez, pero es muy común tener dos o más tablas con datos relacionados.
En ese caso, tenemos que <em>unir</em> estas tablas.
a partir de una o más variables en común o <em>keys</em>.
En Excel u otro programa de hojas de cálculo, esto se resuelve con la función “VLOOKUP” o “BUSCARV”, en R y en particular dentro del mundo de {dplyr} hay que usar la familia de funciones <code>*_join()</code>.
Hay una función cada tipo de unión que queramos hacer.</p>
<p>Asumiendo que querés unir dos data.frames o tablas <code>x</code> e <code>y</code> que tienen en común una variable <code>A</code>:</p>
<p><img src="img/join.png" /></p>
<ul>
<li><p><code>full_join()</code>: devuelve todas las filas y todas las columnas de ambas tablas <code>x</code> e <code>y</code>.
Cuando no coinciden los elementos en <code>x1</code>, devuelve <code>NA</code> (dato faltante).
Esto significa que no se pierden filas de ninguna de las dos tablas aún cuando no hay coincidencia.
Está es la manera más segura de unir tablas.</p></li>
<li><p><code>left_join()</code>: devuelve todas las filas de <code>x</code> y todas las columnas de <code>x</code> e <code>y</code>.
Las filas en <code>x</code> que no tengan coincidencia con <code>y</code> tendrán <code>NA</code> en las nuevas columnas.
Si hay múltiples coincidencias entre <code>x</code>e <code>y</code>, devuelve todas las coincidencias posibles.</p></li>
<li><p><code>right_join()</code>: es igual que <code>left_join()</code> pero intercambiando el orden de <code>x</code> e <code>y</code>.
En otras palabras, <code>right_join(x, y)</code> es idéntico a <code>left_join(y, x)</code>.</p></li>
<li><p><code>inner_join()</code>: devuelve todas las filas de <code>x</code> donde hay coincidencias con <code>y</code> y todas las columnas de <code>x</code> e <code>y</code>.
Si hay múltiples coincidencias entre <code>x</code> e <code>y</code>, entonces devuelve todas las coincidencias.
Esto significa que eliminará las filas (observaciones) que no coincidan en ambas tablas, lo que puede ser peligroso.</p></li>
</ul>
<p><img src="img/join_family.png" /></p>
<p>Ahora vamos a seguir trabajando con las base de datos de <code>paises</code> pero nos vamos a quedar solo con las observaciones del 2007 y de paso unirlo a una nueva base de datos <code>co2</code> que contiene información de la emisión de dióxido de carbono de cada país para ese mismo año.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb183-1" aria-hidden="true" tabindex="-1"></a>paises_2007 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;datos/paises.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb183-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) </span>
<span id="cb183-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb183-4" aria-hidden="true" tabindex="-1"></a>co2_2007 <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;datos/co2_2007.csv&quot;</span>)</span>
<span id="cb183-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb183-5" aria-hidden="true" tabindex="-1"></a>co2_2007</span></code></pre></div>
<pre><code>## # A tibble: 218 × 3
##    codigo_iso emision_co2 pais                  
##    &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;                 
##  1 ABW            27.9    Aruba                 
##  2 AFG             0.0854 Afghanistán           
##  3 AGO             1.20   Angola                
##  4 ALB             1.32   Albania               
##  5 AND             6.52   Andorra               
##  6 ARB             4.10   Mundo Árabe           
##  7 ARE            22.4    Emiratos Árabes Unidos
##  8 ARG             4.38   Argentina             
##  9 ARM             1.73   Armenia               
## 10 ATG             5.14   Antigua y Barbuda     
## # … with 208 more rows</code></pre>
<p>Esta nueva tabla tiene 3 columnas: <code>codigo_iso</code> tiene el código ISO de 3 letras de (abreviaturas que se usan internacionalmente), <code>emision_co2</code> tiene las emisiones anuales per cápita de CO2 en toneladas, <code>pais</code> tiene el nombre del país.
Esta última columna también está presente en la tabla <code>paises_2007</code> y es la que va a servir como variable llave para unir las dos tablas.</p>
<p>Para unir las dos tablas, cualquier función <em>join</em> requiere cierta información:</p>
<ul>
<li>las tablas a unir: son los dos primeros argumentos.</li>
<li>qué variable o variables (se puede usar más de una!) usar para identificar coincidencias: el argumento <code>by</code>.</li>
</ul>
<p>Unamos <code>paises_2007</code> y <code>co2_2007</code> primero con <code>full_join()</code>:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb185-1" aria-hidden="true" tabindex="-1"></a>paises_co2_2007 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(paises_2007, co2_2007, <span class="at">by =</span> <span class="st">&quot;pais&quot;</span>)</span>
<span id="cb185-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb185-2" aria-hidden="true" tabindex="-1"></a>paises_co2_2007</span></code></pre></div>
<pre><code>## # A tibble: 241 × 8
##    pais       continente  anio esperanza_de_vida poblacion pib_per_capita
##    &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;             &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;
##  1 Afganistán Asia        2007              43.8  31889923           975.
##  2 Albania    Europa      2007              76.4   3600523          5937.
##  3 Argelia    África      2007              72.3  33333216          6223.
##  4 Angola     África      2007              42.7  12420476          4797.
##  5 Argentina  Américas    2007              75.3  40301927         12779.
##  6 Australia  Oceanía     2007              81.2  20434176         34435.
##  7 Austria    Europa      2007              79.8   8199783         36126.
##  8 Baréin     Asia        2007              75.6    708573         29796.
##  9 Bangladesh Asia        2007              64.1 150448339          1391.
## 10 Bélgica    Europa      2007              79.4  10392226         33693.
## # … with 231 more rows, and 2 more variables: codigo_iso &lt;chr&gt;,
## #   emision_co2 &lt;dbl&gt;</code></pre>
<p>Si miramos de cerca la tabla unida veremos un par de cosas:</p>
<ul>
<li>Todas las columnas de <code>paises_2007</code> y de <code>co2_2007</code> están presentes.</li>
<li>Todas las observaciones están presentes, aún los países que están presentes en <code>co2_2007</code> pero no en <code>paises_2007</code> y viceversa. En esos casos ahora tenemos <code>NA</code>. Esto genera una tabla con 241 filas.</li>
</ul>
<p>Esta es la opción más segura si no sabemos si todas las observaciones de una tabla están presente en a otra.</p>
<p>Si solo nos interesa conservar las filas de la tabla <em>de la izquierda</em>, en este caso <code>paises_2007</code> entonces:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb187-1" aria-hidden="true" tabindex="-1"></a>paises_co2_2007 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(paises_2007, co2_2007, <span class="at">by =</span> <span class="st">&quot;pais&quot;</span>)</span>
<span id="cb187-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb187-2" aria-hidden="true" tabindex="-1"></a>paises_co2_2007</span></code></pre></div>
<pre><code>## # A tibble: 142 × 8
##    pais       continente  anio esperanza_de_vida poblacion pib_per_capita
##    &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt;             &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;
##  1 Afganistán Asia        2007              43.8  31889923           975.
##  2 Albania    Europa      2007              76.4   3600523          5937.
##  3 Argelia    África      2007              72.3  33333216          6223.
##  4 Angola     África      2007              42.7  12420476          4797.
##  5 Argentina  Américas    2007              75.3  40301927         12779.
##  6 Australia  Oceanía     2007              81.2  20434176         34435.
##  7 Austria    Europa      2007              79.8   8199783         36126.
##  8 Baréin     Asia        2007              75.6    708573         29796.
##  9 Bangladesh Asia        2007              64.1 150448339          1391.
## 10 Bélgica    Europa      2007              79.4  10392226         33693.
## # … with 132 more rows, and 2 more variables: codigo_iso &lt;chr&gt;,
## #   emision_co2 &lt;dbl&gt;</code></pre>
<p>Ahora esperamos que la tabla resultante tenga la misma cantidad de filas que <code>paises_2007</code> y efectivamente eso ocurre.
Pero al mismo tiempo varios países en esa tabla no encontraron coincidencia en <code>co2_2007</code> y por esa razón, la columna nueva columna <code>emisiones_co2</code> tiene <code>NA</code>.</p>
<p>Finalmente, si quisiéramos quedarnos solo con las observaciones que están presentes en ambas tablas usamos <code>inner_join()</code>.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb189-1" aria-hidden="true" tabindex="-1"></a>paises_co2_2007 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(paises_2007, co2_2007, <span class="at">by =</span> <span class="st">&quot;pais&quot;</span>)</span>
<span id="cb189-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb189-2" aria-hidden="true" tabindex="-1"></a>paises_co2_2007</span></code></pre></div>
<pre><code>## # A tibble: 119 × 8
##    pais    continente  anio esperanza_de_vi… poblacion pib_per_capita
##    &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;            &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;
##  1 Albania Europa      2007             76.4   3600523          5937.
##  2 Angola  África      2007             42.7  12420476          4797.
##  3 Argent… Américas    2007             75.3  40301927         12779.
##  4 Austra… Oceanía     2007             81.2  20434176         34435.
##  5 Austria Europa      2007             79.8   8199783         36126.
##  6 Bangla… Asia        2007             64.1 150448339          1391.
##  7 Bélgica Europa      2007             79.4  10392226         33693.
##  8 Bolivia Américas    2007             65.6   9119152          3822.
##  9 Bosnia… Europa      2007             74.9   4552198          7446.
## 10 Botswa… África      2007             50.7   1639131         12570.
## # … with 109 more rows, and 2 more variables: codigo_iso &lt;chr&gt;,
## #   emision_co2 &lt;dbl&gt;</code></pre>
<p>En este caso, perdemos las filas de <code>co2_2007</code> que no encontraron coincidencia en <code>paises_2007</code> y viceversa y la tabla resultante tiene aún menos filas (119).</p>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>Estuvimos trabajando con una parte de la base de datos de emisiones.
Pero también está disponible <code>co2_completo.csv</code> que contiene las emisiones para distintos años.
El objetivo es que unas <code>paises</code> y <code>co2</code> teniendo en cuenta tanto el país como el año.
Para eso:</p>
<ol style="list-style-type: decimal">
<li>Lee la base de datos <code>co2_completo.csv</code> en una nueva variable que se llame <code>co2</code>.</li>
<li>Revisá el nombre de las variables en esta base de datos, ¿se llaman igual que las variables en <code>paises</code>?</li>
<li>Uní las dos tablas usando <code>full_join()</code>, tené en cuenta que ahora usamos dos variables llave <code>pais</code> y <code>anio</code>. Buscá en la documentación cómo indicarle eso a la función <code>full_join()</code>.<br />
</li>
</ol>
</div>

</div>
<div id="reportes-ii" class="section level2" number="7.8">
<h2><span class="header-section-number">7.8</span> Reportes II</h2>
<p>Durante este curso fuiste creando varios documentos con R Markdown en HTML. Este es un formato que tiene un montón de flexibilidad, pero seguramente no es el único que necesitás. Casi seguro que los informes los tengas que presentar en formato PDF o, incluso, ¡en papel impreso! {Rmarkdown}, y todo un amplio ecosistema de otros paquetes, permite generar documentos en múltiples formatos usando el mismo archivo de texto plano.</p>
</div>
<div id="eligiendo-el-formato-de-salida" class="section level2" number="7.9">
<h2><span class="header-section-number">7.9</span> Eligiendo el formato de salida</h2>
<p>Ya habrás visto esto cuando creás un archivo markdown nuevo, RStudio te permite elegir entre tres formatos de salida:</p>
<p><img src="img/nuevo-rmd.png" /></p>
<p>Cuál es el formato de salida de un archivo de R Markdown se determina principalmente con la opción <code>output</code> en el encabezado yaml. Si mirás el encabezado del <a href="files/mi-primer-rmarkdown.Rmd">archivo R Markdown de ejemplo</a> vas a ver que la opción <code>output</code> dice <code>html_document</code>.</p>
<p><img src="img/rmd-ejemplo-secciones.png" /></p>
<p>Ese <code>html_document</code> no es otra cosa que una función de {Rmarkdown} llamada <code>html_document</code>. Como te podrás imaginar, {Rmarkdown} tiene una serie de otras funciones que definen formatos de salida. Los dos que seguramente te van a servir más son <code>pdf_document</code> y <code>word_document</code> que justamente generan PDFs y archivos de Word, respectivamente.</p>
<p>Para crear un documento de R Markdown que genere un archivo PDF basta con cambiar el <code>output</code> en el encabezado por esto:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb191-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb191-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> pdf_document</span></span>
<span id="cb191-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
<p>Para que el documento se genere correctamente hace falta instalar LaTeX, que es un sistema de composición de textos. Aunque parezca mentira, la mejor forma de instalar LaTeX para usar R Markdown es instalando el paquete {<a href="https://yihui.org/tinytex/">tinytex</a>} con <code>install.packages("tinytex")</code> y luego correr <code>tinytex::install_tinytex()</code>. Esto va a instalar una versión pequeña de LaTeX en un lugar donde luego {Rmarkdown} lo puede usar. Esta es la forma altamente recomendada para generar PDFs con R Markdown que va a evitarte un montón de dolores de cabeza.</p>
<p>Análogamente, podés generar un archivo de word cambiando el <code>output</code> así:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb192-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb192-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> word_document</span></span>
<span id="cb192-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
<p>Y ya está. En la gran mayoría de los casos no vas a tener que modificar nada más del código ni el texto.</p>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>Agarrá el reporte que estuviste armando en los desafíos o alguno que usaste durante el curso y compilalo en PDF y luego en Word.</p>
</div>
</div>
<div id="personalizando-la-salida" class="section level2" number="7.10">
<h2><span class="header-section-number">7.10</span> Personalizando la salida</h2>
<p>Cada función de formato viene con sus opciones de personalización que podés acceder leyendo su documentación. Para ver la documentación de <code>html_document</code>, usa este comando:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb193-1" aria-hidden="true" tabindex="-1"></a>?rmarkdown<span class="sc">::</span>html_document</span></code></pre></div>
<p>Vas a ver que tiene un montón de argumentos que modifican la salida. La forma de setear estos argumentos en un documento de R Markdown es, de nuevo, en el encabezado. Cada argumento de la función de salida (<code>html_document</code> en este caso) es un elemento debajo de la función de output.</p>
<p>Por ejemplo, para que un documento de html tenga una tabla de contenidos hay que setear el argumento <code>toc</code> (de <strong>t</strong>able <strong>o</strong>f <strong>c</strong>ontents) a <code>TRUE</code>. En el encabezado, esto queda así:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb194-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb194-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb194-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html_document</span><span class="kw">:</span></span>
<span id="cb194-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">TRUE</span></span>
<span id="cb194-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
<p>Conviene mirar eso con un poco de detenimiento porque requiere “traducir” código de R –cual los argumentos de una función se fijan entre paréntesis y con <code>=</code>– en código de yaml –donde los argumentos de la función son una lista cuyos elementos se definen con <code>:</code>.</p>
<p>En R lo que vemos como <code>html_document(toc = TRUE)</code> se traduce a yaml como</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb195-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">html_document</span><span class="kw">:</span></span>
<span id="cb195-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">TRUE</span></span></code></pre></div>
<p>Si vas a la ayuda de <code>pdf_document</code> vas a ver que también tiene un argumento llamado <code>toc</code>. Algunos argumentos son compartidos, lo cual hace que se aún más fácil generar un mismo reporte en muchos formatos haciendo muy pocos cambios.</p>
<p>Una forma rápida de hacer tus informes más vistosos es cambiarle el tema visual. <code>html_document</code> permite elegir entre una serie de temas usando el argumento <code>theme</code>. Por ejemplo, poniendo esto en el encabezado, generás un documento HTML con un fondo oscuro</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb196-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb196-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html_document</span><span class="kw">:</span></span>
<span id="cb196-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">TRUE</span></span>
<span id="cb196-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">theme</span><span class="kw">:</span><span class="at"> darkly</span></span></code></pre></div>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>Andá a la ayuda de <code>html_document</code> y fijate cuáles son los valores válidos para el argumento <code>theme</code>. ¡Probá algunos!</p>
</div>
</div>
<div id="reportes-parametrizados" class="section level2" number="7.11">
<h2><span class="header-section-number">7.11</span> Reportes parametrizados</h2>
<p>Es muy común tener que hacer un reporte cuyo resultado dependa de ciertos parámetros.</p>
<p>Por ejemplo, podrías tener un reporte que analiza la evolución de la expectativa de vida de Argentina con el siguiente código</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb197-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb197-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb197-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb197-5" aria-hidden="true" tabindex="-1"></a>paises <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;datos/paises.csv&quot;</span>)</span>
<span id="cb197-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb197-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-7"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb197-7" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb197-8"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb197-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pais <span class="sc">==</span> <span class="st">&quot;Argentina&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb197-9"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb197-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(anio, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb197-10"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb197-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="DT6_files/figure-html/unnamed-chunk-104-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si ahora querés hacer el mismo reporte pero para Uruguay, tenés que abrir el archivo y modificar la llamada a <code>filter</code> para quedarte sólo con ese país:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb198-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb198-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb198-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb198-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb198-5" aria-hidden="true" tabindex="-1"></a>paises <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;datos/paises.csv&quot;</span>)</span>
<span id="cb198-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb198-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-7"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb198-7" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb198-8"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb198-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pais <span class="sc">==</span> <span class="st">&quot;Uruguay&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb198-9"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb198-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(anio, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb198-10"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb198-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p>Si el reporte es largo y usa el nombre del país en múltiples lugares cambiar “Argentina” por “Uruguay” puede ser tedioso y propenso a error, ya que te obliga a modificar muchas partes del código. Y si después tenés que hacer el mismo reporte para Chile…</p>
<p>En estas situaciones podés crear un reporte parametrizado. La idea es que el reporte tiene una serie de parámetros que puede modificar la salida. Es como si el archivo de R Markdown fuera una gran función con sus argumentos!</p>
<p>Para generar un reporte parametrizado hay que agregar un elemento llamado <code>params</code> al encabezado con la lista de parámetros y sus valores por default.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb199-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb199-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pais</span><span class="kw">:</span><span class="at"> Argentina</span></span></code></pre></div>
<p>Luego, en el código de R vas a tener acceso a una variable llamada <code>params</code> que es una lista que contiene los parámetros y su valor. Para acceder al valor de cada parámetros se usa el operador <code>$</code> de la siguiente manera:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb200-1" aria-hidden="true" tabindex="-1"></a>params<span class="sc">$</span>pais</span></code></pre></div>
<pre><code>## [1] &quot;Argentina&quot;</code></pre>
<p>De esta manera, el código original se puede modificar para usar el valor del país almacenado en <code>params$pais</code></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb202-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb202-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb202-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb202-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb202-5" aria-hidden="true" tabindex="-1"></a>paises <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;datos/paises.csv&quot;</span>)</span>
<span id="cb202-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb202-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-7"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb202-7" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb202-8"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb202-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pais <span class="sc">==</span> params<span class="sc">$</span>pais) <span class="sc">%&gt;%</span> </span>
<span id="cb202-9"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb202-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(anio, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb202-10"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb202-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p>Y ahora el mismo código puede funcionar para distintos países. Para crear reportes distintos para cada país sólo hay que modificar el valor del parámetro en el encabezado:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb203-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb203-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pais</span><span class="kw">:</span><span class="at"> Uruguay</span></span></code></pre></div>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>Agregá al menos un parámetro al reporte que venís armando.</p>
</div>
</div>
<div id="control-de-chunks" class="section level2" number="7.12">
<h2><span class="header-section-number">7.12</span> Control de chunks</h2>
<p>Si te acordás, en la sección de <a href="10-reportes-I.html">reportes I</a> te dijimos que un chunk tiene una pinta como esta:</p>
<pre><code>```{r nombre-del-chunk}

```</code></pre>
<p>Ponerle nombre al chunk no es obligatorio pero está bueno para tener una idea de qué hace cada uno, lo cual se vuelve más importante a medida que un reporte se vuelve más largo y complejo. Pero lo que no dijimos es que además del nombre, entre las llave se pueden poner un montón de opciones que cambian el comportamiento y la apariencia del resultado del chunk.</p>
<p>Para cambiar las opciones de un chunk, lo único que hay que hacer es listarlas dentro de los corchetes. Por ejemplo:</p>
<pre><code>```{r nombre-del-chunk, echo = FALSE, message = FALSE}

```</code></pre>
<p>Hay una serie de opciones particularmente importante es la que controla si el código se ejecuta y si el resultado del código va a quedar en el reporte o no:</p>
<ul>
<li><p><code>eval = FALSE</code> evita que se corra el código del chunk, de manera que tampoco va a mostrar resultados. Es útil para mostrar códigos de ejemplo si estás escribiendo, por ejemplo un documento para enseñar R.</p></li>
<li><p><code>echo = FALSE</code> corre el código del chunk y muestra los resultados, pero oculta el código en el reporte. Esto es útil para escribir reportes para personas que no necesitan ver el código de R que generó el gráfico o tabla.</p></li>
<li><p><code>include = FALSE</code> corre el código pero oculta tanto el código como los resultados. Es útil para usar en chunks de configuración general donde cargas las librerías.</p></li>
</ul>
<p>Si estás escribiendo un informe en el que no querés que se muestre ningún código, agregarle <code>echo = FALSE</code> a cada chunk nuevo se vuelve tedioso. La solución es cambiar la opción de forma global de manera que aplique a todos los chunks. Esto se hace mediante la función <code>knitr::opts_chunk$set()</code>, que setea las opciones globales de los chunks que le siguen. Si queŕes que todos los chunks tengan <code>echo = TRUE</code> crearías un chunk así:</p>
<pre><code>```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```</code></pre>
<p>Generalmente tiene sentido poner esto en el primer chunk de un documento, que como suele ser cuestiones de configuración del reporte, también conviene ponerle <code>include = FALSE</code>.</p>
<p>Habrás visto que a vece algunas funciones escupen mensajes sobre lo que hacen. Por ejemplo, cuando <code>read_csv</code> lee un archivo describe el tipo de dato de cada columna:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb207-1" aria-hidden="true" tabindex="-1"></a>paises <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;datos/paises.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 1704 Columns: 6</code></pre>
<pre><code>## ── Column specification ─────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (2): pais, continente
## dbl (4): anio, esperanza_de_vida, poblacion, pib_per_capita</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>Esto es útil cuando uno está haciendo trabajo interactivo pero en general no quiere que quede en el reporte. Para que no muestre estos mensajes basta con poner la opción <code>message = FALSE</code></p>
<pre><code>```{r message = FALSE}
paises &lt;- read_csv(&quot;datos/paises.csv&quot;)
```</code></pre>
<p>En general no pasa nada si ignorás los mensajes. Son cuestiones diagnósticas extra que sirven para que vos, como humano, te enteres de lo que hizo una función. Distinto son las advertencias, o “warnings”. Una advertencia te está diciendo que hay algo “raro” en el código que puede significar que hay algo mal. No llega al nivel de error, que es algo que literalmente “no computa”. Por ejemplo, <code>sqrt</code> tira una advertencia cuando recibe números negativos.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb212-1" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Warning in sqrt(-1): NaNs produced</code></pre>
<p>Si un chunk tira una advertencia que es esperable pero no querés que aparezca en el reporte, podés ocultarlas con la opción <code>warning = FALSE</code>.</p>
<pre><code>```{r warning = FALSE}
i &lt;- sqrt(-1)
```</code></pre>
<p>Finalmente, una opción tan poderosa como peligrosa es <code>cache = TRUE</code>. Lo que hace es que en vez de correr el código de un chunk cada vez que <em>kniteás</em> el documento, guarda el resultado del chunk en el disco para reutilizar la próxima vez que crees el reporte. Esto es muy cómo si un chunk se un código que tarda mucho en correr. Por ejemplo el siguiente chunk va a tardar 10 minutos en correr la primera vez que knitees el reporte, pero luego va a ser mucho más rápido:</p>
<pre><code>```{r cache = FALSE}
datos &lt;- funcion_que_tarda_10_minutos(x)
```</code></pre>
<p>{knitr} es bastante inteligente y va a invalidar la cache si cambia el código del chunk. Pero, ¿qué pasa si cambiás algo del código previo que cambia el valor de <code>x</code> o incluso el funcionamiento de <code>function_que_targa_10_minutos</code>? {knitr} no se da cuenta y va a usar la cache, resultando que <code>datos</code> va a tener un valor incorrecto. Hay formas de decirle a {knitr} de qué depende cada chunk y así obtener una cache más “inteligente” pero es algo que se vuelve complicado muy rápido.</p>
<p>El resumen es usar la cache sólo cuando es imprescindible.</p>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>Guardá el cógido de esta u otra sección yendo a Código → Descargar Rmd arriba de todo a la derecha. Mirá los chunks y las opciones que están puestas. ¿Por qué usamos cada opción en cada chunk?</p>
</div>
<div class="btn-group" role="group" aria-label="Navegación">
<p><a href= "09-funciones.html" class = "btn btn-primary">Anterior</a>
<a href= "11-tablas.html" class = "btn btn-primary">Siguiente</a></p>
</div>

</div>
<div id="tablas" class="section level2" number="7.13">
<h2><span class="header-section-number">7.13</span> Tablas</h2>
<p>Por defecto, la forma en que R Markdown muestra tablas es bastante feo porque muestra lo que verías si corrieras el código en la consola.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb216-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb216-2" aria-hidden="true" tabindex="-1"></a>paises <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;datos/paises.csv&quot;</span>)</span>
<span id="cb216-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb216-3" aria-hidden="true" tabindex="-1"></a>paises_seleccion <span class="ot">&lt;-</span> paises <span class="sc">%&gt;%</span> </span>
<span id="cb216-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pais <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Argentina&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>, <span class="st">&quot;Chile&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb216-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb216-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2007</span>, <span class="dv">2002</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb216-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb216-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>continente)</span>
<span id="cb216-7"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb216-7" aria-hidden="true" tabindex="-1"></a>paises_seleccion</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   pais       anio esperanza_de_vida poblacion pib_per_capita
##   &lt;chr&gt;     &lt;dbl&gt;             &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;
## 1 Argentina  2002              74.3  38331121          8798.
## 2 Argentina  2007              75.3  40301927         12779.
## 3 Chile      2002              77.9  15497046         10779.
## 4 Chile      2007              78.6  16284741         13172.
## 5 Uruguay    2002              75.3   3363085          7727.
## 6 Uruguay    2007              76.4   3447496         10611.</code></pre>
</div>
<div id="tablas-simples-con-kable" class="section level2" number="7.14">
<h2><span class="header-section-number">7.14</span> Tablas simples con <code>kable</code></h2>
<p>Existen varios paquetes para mostrar tablas lindas pero una forma simple y sin vueltas es usando la función <code>kable</code> del paquete {knitr}.
Sólo usando esta función ya devuelve una tabla más que razonable:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb218-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(paises_seleccion)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">pais</th>
<th align="right">anio</th>
<th align="right">esperanza_de_vida</th>
<th align="right">poblacion</th>
<th align="right">pib_per_capita</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Argentina</td>
<td align="right">2002</td>
<td align="right">74.340</td>
<td align="right">38331121</td>
<td align="right">8797.641</td>
</tr>
<tr class="even">
<td align="left">Argentina</td>
<td align="right">2007</td>
<td align="right">75.320</td>
<td align="right">40301927</td>
<td align="right">12779.380</td>
</tr>
<tr class="odd">
<td align="left">Chile</td>
<td align="right">2002</td>
<td align="right">77.860</td>
<td align="right">15497046</td>
<td align="right">10778.784</td>
</tr>
<tr class="even">
<td align="left">Chile</td>
<td align="right">2007</td>
<td align="right">78.553</td>
<td align="right">16284741</td>
<td align="right">13171.639</td>
</tr>
<tr class="odd">
<td align="left">Uruguay</td>
<td align="right">2002</td>
<td align="right">75.307</td>
<td align="right">3363085</td>
<td align="right">7727.002</td>
</tr>
<tr class="even">
<td align="left">Uruguay</td>
<td align="right">2007</td>
<td align="right">76.384</td>
<td align="right">3447496</td>
<td align="right">10611.463</td>
</tr>
</tbody>
</table>
<p>La mayoría de las veces, el nombre de las columnas que queremos mostrar no va a ser igual que el nombre de las columnas en R.
En la tabla <code>paises</code>, los nombres están en minúscula, sin espacios y sin “caracteres especiales” como “ñ” o “í”.
Esto es útil para comunicarse con R, pero no está bueno para comunicados a seres humanos.
El argumento <code>col.names</code> permite especificar el nombre de las columnas para mostrar:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(paises_seleccion, </span>
<span id="cb219-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb219-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;País&quot;</span>, <span class="st">&quot;Año&quot;</span>, <span class="st">&quot;Esperanza de vida&quot;</span>, <span class="st">&quot;Población&quot;</span>, <span class="st">&quot;PBI per cápita&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">País</th>
<th align="right">Año</th>
<th align="right">Esperanza de vida</th>
<th align="right">Población</th>
<th align="right">PBI per cápita</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Argentina</td>
<td align="right">2002</td>
<td align="right">74.340</td>
<td align="right">38331121</td>
<td align="right">8797.641</td>
</tr>
<tr class="even">
<td align="left">Argentina</td>
<td align="right">2007</td>
<td align="right">75.320</td>
<td align="right">40301927</td>
<td align="right">12779.380</td>
</tr>
<tr class="odd">
<td align="left">Chile</td>
<td align="right">2002</td>
<td align="right">77.860</td>
<td align="right">15497046</td>
<td align="right">10778.784</td>
</tr>
<tr class="even">
<td align="left">Chile</td>
<td align="right">2007</td>
<td align="right">78.553</td>
<td align="right">16284741</td>
<td align="right">13171.639</td>
</tr>
<tr class="odd">
<td align="left">Uruguay</td>
<td align="right">2002</td>
<td align="right">75.307</td>
<td align="right">3363085</td>
<td align="right">7727.002</td>
</tr>
<tr class="even">
<td align="left">Uruguay</td>
<td align="right">2007</td>
<td align="right">76.384</td>
<td align="right">3447496</td>
<td align="right">10611.463</td>
</tr>
</tbody>
</table>
<p>En Español, en general usamos la coma para separar los decimales y el punto como separador de miles.
Para eso, hay que modificar el argumento <code>format.args</code> de esta manera:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(paises_seleccion, </span>
<span id="cb220-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb220-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;País&quot;</span>, <span class="st">&quot;Año&quot;</span>, <span class="st">&quot;Esperanza de vida&quot;</span>, <span class="st">&quot;Población&quot;</span>, <span class="st">&quot;PBI per cápita&quot;</span>),</span>
<span id="cb220-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb220-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">decimal.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">big.mark =</span> <span class="st">&quot;.&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">País</th>
<th align="right">Año</th>
<th align="right">Esperanza de vida</th>
<th align="right">Población</th>
<th align="right">PBI per cápita</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Argentina</td>
<td align="right">2.002</td>
<td align="right">74,340</td>
<td align="right">38.331.121</td>
<td align="right">8.797,641</td>
</tr>
<tr class="even">
<td align="left">Argentina</td>
<td align="right">2.007</td>
<td align="right">75,320</td>
<td align="right">40.301.927</td>
<td align="right">12.779,380</td>
</tr>
<tr class="odd">
<td align="left">Chile</td>
<td align="right">2.002</td>
<td align="right">77,860</td>
<td align="right">15.497.046</td>
<td align="right">10.778,784</td>
</tr>
<tr class="even">
<td align="left">Chile</td>
<td align="right">2.007</td>
<td align="right">78,553</td>
<td align="right">16.284.741</td>
<td align="right">13.171,639</td>
</tr>
<tr class="odd">
<td align="left">Uruguay</td>
<td align="right">2.002</td>
<td align="right">75,307</td>
<td align="right">3.363.085</td>
<td align="right">7.727,002</td>
</tr>
<tr class="even">
<td align="left">Uruguay</td>
<td align="right">2.007</td>
<td align="right">76,384</td>
<td align="right">3.447.496</td>
<td align="right">10.611,463</td>
</tr>
</tbody>
</table>
<p>Uff… pero ponerle el punto de miles a los años queda raro.
La solución es convertir la columna <code>anio</code> en caracter.
De esta manera, no se ve afectada por el formato numérico.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb221-1" aria-hidden="true" tabindex="-1"></a>paises_seleccion <span class="sc">%&gt;%</span> </span>
<span id="cb221-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">anio =</span> <span class="fu">as.character</span>(anio)) <span class="sc">%&gt;%</span> </span>
<span id="cb221-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;País&quot;</span>, <span class="st">&quot;Año&quot;</span>, <span class="st">&quot;Esperanza de vida&quot;</span>, <span class="st">&quot;Población&quot;</span>, <span class="st">&quot;PBI per cápita&quot;</span>),</span>
<span id="cb221-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb221-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">decimal.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">big.mark =</span> <span class="st">&quot;.&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">País</th>
<th align="left">Año</th>
<th align="right">Esperanza de vida</th>
<th align="right">Población</th>
<th align="right">PBI per cápita</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Argentina</td>
<td align="left">2002</td>
<td align="right">74,340</td>
<td align="right">38.331.121</td>
<td align="right">8.797,641</td>
</tr>
<tr class="even">
<td align="left">Argentina</td>
<td align="left">2007</td>
<td align="right">75,320</td>
<td align="right">40.301.927</td>
<td align="right">12.779,380</td>
</tr>
<tr class="odd">
<td align="left">Chile</td>
<td align="left">2002</td>
<td align="right">77,860</td>
<td align="right">15.497.046</td>
<td align="right">10.778,784</td>
</tr>
<tr class="even">
<td align="left">Chile</td>
<td align="left">2007</td>
<td align="right">78,553</td>
<td align="right">16.284.741</td>
<td align="right">13.171,639</td>
</tr>
<tr class="odd">
<td align="left">Uruguay</td>
<td align="left">2002</td>
<td align="right">75,307</td>
<td align="right">3.363.085</td>
<td align="right">7.727,002</td>
</tr>
<tr class="even">
<td align="left">Uruguay</td>
<td align="left">2007</td>
<td align="right">76,384</td>
<td align="right">3.447.496</td>
<td align="right">10.611,463</td>
</tr>
</tbody>
</table>
<p>hacer <code>kable</code>, que es una función diseñada para ser simple y hacer pocas cosas.
Para hacer cosas un poco mas complicadas está el paquete {kableExtra}.</p>
</div>
<div id="supertablas-con-kableextra" class="section level2" number="7.15">
<h2><span class="header-section-number">7.15</span> Supertablas con {kableExtra}</h2>
<p>El paquete {kableExtra}, como su nombre lo indica, nació para extender el poder de la función <code>kable</code>.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)  <span class="co"># instalar con install.packages(&quot;kableExtra&quot;)</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;kableExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     group_rows</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb225-1" aria-hidden="true" tabindex="-1"></a>paises_tabla <span class="ot">&lt;-</span> paises_seleccion <span class="sc">%&gt;%</span> </span>
<span id="cb225-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">anio =</span> <span class="fu">as.character</span>(anio)) <span class="sc">%&gt;%</span> </span>
<span id="cb225-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;País&quot;</span>, <span class="st">&quot;Año&quot;</span>, <span class="st">&quot;Esperanza de vida&quot;</span>, <span class="st">&quot;Población&quot;</span>, <span class="st">&quot;PBI per cápita&quot;</span>),</span>
<span id="cb225-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb225-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">decimal.mark =</span> <span class="st">&quot;,&quot;</span>, <span class="at">big.mark =</span> <span class="st">&quot;.&quot;</span>))</span></code></pre></div>
<p>La primera columna de la tabla de arriba es un tanto redundante.
Sería mejor agrupar las filas según el país.
Esto se consigue con la función <code>collapse_rows</code>:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb226-1" aria-hidden="true" tabindex="-1"></a>paises_tabla <span class="sc">%&gt;%</span> </span>
<span id="cb226-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">&quot;top&quot;</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb226-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>() </span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
País
</th>
<th style="text-align:left;">
Año
</th>
<th style="text-align:right;">
Esperanza de vida
</th>
<th style="text-align:right;">
Población
</th>
<th style="text-align:right;">
PBI per cápita
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Argentina
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
74,340
</td>
<td style="text-align:right;">
38.331.121
</td>
<td style="text-align:right;">
8.797,641
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
75,320
</td>
<td style="text-align:right;">
40.301.927
</td>
<td style="text-align:right;">
12.779,380
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Chile
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
77,860
</td>
<td style="text-align:right;">
15.497.046
</td>
<td style="text-align:right;">
10.778,784
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
78,553
</td>
<td style="text-align:right;">
16.284.741
</td>
<td style="text-align:right;">
13.171,639
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Uruguay
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
75,307
</td>
<td style="text-align:right;">
3.363.085
</td>
<td style="text-align:right;">
7.727,002
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
76,384
</td>
<td style="text-align:right;">
3.447.496
</td>
<td style="text-align:right;">
10.611,463
</td>
</tr>
</tbody>
</table>
<p>El primer argumento es el número de la columna que queremos agrupar.
En este caso, la columna <code>pais</code> es la primera.
El segundo argumento es la alineación vertical.
Por defecto, <code>collapse_rows</code> pone las etiquetas en el centro, pero la convención más general es ponerlas arriba.</p>
<p>¿Qué es esa <code>kable_styling()</code>?
{kableExtra} permite cambiar el estilo de las tablas muy fácilmente.
<code>kable_styling</code> es el estilo por defecto, que es igual al que produce <code>kable</code>, pero tiene muchos otros.
Si viste tablas hechas en LaTeX, quizás este estilo te resulte familiar:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb227-1" aria-hidden="true" tabindex="-1"></a>paises_tabla <span class="sc">%&gt;%</span> </span>
<span id="cb227-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb227-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">&quot;top&quot;</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb227-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic_2</span>()</span></code></pre></div>
<table class=" lightable-classic-2" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
País
</th>
<th style="text-align:left;">
Año
</th>
<th style="text-align:right;">
Esperanza de vida
</th>
<th style="text-align:right;">
Población
</th>
<th style="text-align:right;">
PBI per cápita
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Argentina
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
74,340
</td>
<td style="text-align:right;">
38.331.121
</td>
<td style="text-align:right;">
8.797,641
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
75,320
</td>
<td style="text-align:right;">
40.301.927
</td>
<td style="text-align:right;">
12.779,380
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Chile
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
77,860
</td>
<td style="text-align:right;">
15.497.046
</td>
<td style="text-align:right;">
10.778,784
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
78,553
</td>
<td style="text-align:right;">
16.284.741
</td>
<td style="text-align:right;">
13.171,639
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Uruguay
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
75,307
</td>
<td style="text-align:right;">
3.363.085
</td>
<td style="text-align:right;">
7.727,002
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
76,384
</td>
<td style="text-align:right;">
3.447.496
</td>
<td style="text-align:right;">
10.611,463
</td>
</tr>
</tbody>
</table>
<p>La función <code>column_spec</code> permite cambiar los parámetros gráficos de una o más columnas.
En este caso cambiamos la primera columna (<code>column = 1</code>) para que las palabras aparezcan italizadas (<code>italic = TRUE</code>):</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb228-1" aria-hidden="true" tabindex="-1"></a>paises_tabla <span class="sc">%&gt;%</span> </span>
<span id="cb228-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb228-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="at">column =</span> <span class="dv">1</span>, <span class="at">italic =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb228-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">&quot;top&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb228-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>() </span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
País
</th>
<th style="text-align:left;">
Año
</th>
<th style="text-align:right;">
Esperanza de vida
</th>
<th style="text-align:right;">
Población
</th>
<th style="text-align:right;">
PBI per cápita
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-style: italic;vertical-align: top !important;" rowspan="2">
Argentina
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
74,340
</td>
<td style="text-align:right;">
38.331.121
</td>
<td style="text-align:right;">
8.797,641
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
75,320
</td>
<td style="text-align:right;">
40.301.927
</td>
<td style="text-align:right;">
12.779,380
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;vertical-align: top !important;" rowspan="2">
Chile
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
77,860
</td>
<td style="text-align:right;">
15.497.046
</td>
<td style="text-align:right;">
10.778,784
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
78,553
</td>
<td style="text-align:right;">
16.284.741
</td>
<td style="text-align:right;">
13.171,639
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;vertical-align: top !important;" rowspan="2">
Uruguay
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
75,307
</td>
<td style="text-align:right;">
3.363.085
</td>
<td style="text-align:right;">
7.727,002
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
76,384
</td>
<td style="text-align:right;">
3.447.496
</td>
<td style="text-align:right;">
10.611,463
</td>
</tr>
</tbody>
</table>
<p>Lo notable de <code>column_spec</code> es que en sus argumentos se pueden poner vectores de manera de generar formato condicional.
Para resaltar con negrita únicamente el país “Argentina”:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb229-1" aria-hidden="true" tabindex="-1"></a>paises_tabla <span class="sc">%&gt;%</span> </span>
<span id="cb229-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="at">column =</span> <span class="dv">1</span>, <span class="at">bold =</span> (paises_seleccion<span class="sc">$</span>pais <span class="sc">==</span> <span class="st">&quot;Argentina&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb229-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">&quot;top&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb229-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>() </span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
País
</th>
<th style="text-align:left;">
Año
</th>
<th style="text-align:right;">
Esperanza de vida
</th>
<th style="text-align:right;">
Población
</th>
<th style="text-align:right;">
PBI per cápita
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;vertical-align: top !important;" rowspan="2">
Argentina
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
74,340
</td>
<td style="text-align:right;">
38.331.121
</td>
<td style="text-align:right;">
8.797,641
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
75,320
</td>
<td style="text-align:right;">
40.301.927
</td>
<td style="text-align:right;">
12.779,380
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Chile
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
77,860
</td>
<td style="text-align:right;">
15.497.046
</td>
<td style="text-align:right;">
10.778,784
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
78,553
</td>
<td style="text-align:right;">
16.284.741
</td>
<td style="text-align:right;">
13.171,639
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Uruguay
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
75,307
</td>
<td style="text-align:right;">
3.363.085
</td>
<td style="text-align:right;">
7.727,002
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
76,384
</td>
<td style="text-align:right;">
3.447.496
</td>
<td style="text-align:right;">
10.611,463
</td>
</tr>
</tbody>
</table>
<p>Conviene detenerse para mirar un poco con detalle el código.
La llamada a <code>column_spec</code> está cambiando el formato de la columna 1.
En particular, va a determinar si el texto es en negrita (bold) o no.
Y la forma para determinarlo es el vector <code>paises$pais == "Argentina"</code>.
¿Qué es ese vector?</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb230-1" aria-hidden="true" tabindex="-1"></a>paises_seleccion<span class="sc">$</span>pais <span class="sc">==</span> <span class="st">&quot;Argentina&quot;</span></span></code></pre></div>
<pre><code>## [1]  TRUE  TRUE FALSE FALSE FALSE FALSE</code></pre>
<p>Por lo tanto, <code>column_spec(column = 1, bold = (paises$pais == "Argentina"))</code> va a hacer que las dos primera filas de la columna uno estén en negrita, y las demás no.
Luego, <code>collapse_rows</code> colapsa las filas según el país y entonces esas dos primeras filas se transforman en una.</p>
<p>Esto da un montón de flexibilidad en el estilo del texto.
Por ejemplo, se puede hacer que el color del texto cambie según el valor usando <code>column_spec</code> y <code>spec_color</code>.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb232-1" aria-hidden="true" tabindex="-1"></a>paises_tabla <span class="sc">%&gt;%</span> </span>
<span id="cb232-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="fu">spec_color</span>(paises_seleccion<span class="sc">$</span>esperanza_de_vida)) <span class="sc">%&gt;%</span> </span>
<span id="cb232-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">&quot;top&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb232-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>() </span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
País
</th>
<th style="text-align:left;">
Año
</th>
<th style="text-align:right;">
Esperanza de vida
</th>
<th style="text-align:right;">
Población
</th>
<th style="text-align:right;">
PBI per cápita
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Argentina
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;color: rgba(68, 1, 84, 1) !important;">
74,340
</td>
<td style="text-align:right;">
38.331.121
</td>
<td style="text-align:right;">
8.797,641
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;color: rgba(61, 77, 138, 1) !important;">
75,320
</td>
<td style="text-align:right;">
40.301.927
</td>
<td style="text-align:right;">
12.779,380
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Chile
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;color: rgba(144, 215, 67, 1) !important;">
77,860
</td>
<td style="text-align:right;">
15.497.046
</td>
<td style="text-align:right;">
10.778,784
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;color: rgba(253, 231, 37, 1) !important;">
78,553
</td>
<td style="text-align:right;">
16.284.741
</td>
<td style="text-align:right;">
13.171,639
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Uruguay
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;color: rgba(61, 77, 138, 1) !important;">
75,307
</td>
<td style="text-align:right;">
3.363.085
</td>
<td style="text-align:right;">
7.727,002
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;color: rgba(34, 141, 141, 1) !important;">
76,384
</td>
<td style="text-align:right;">
3.447.496
</td>
<td style="text-align:right;">
10.611,463
</td>
</tr>
</tbody>
</table>
<p>La función nueva, <code>spec_color</code> genera colores a partir de un vector.
Podés ver cómo funciona en esta linea:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spec_color</span>(paises_seleccion<span class="sc">$</span>esperanza_de_vida)</span></code></pre></div>
<pre><code>## [1] &quot;#440154FF&quot; &quot;#3D4D8AFF&quot; &quot;#90D743FF&quot; &quot;#FDE725FF&quot; &quot;#3D4D8AFF&quot;
## [6] &quot;#228D8DFF&quot;</code></pre>
<p>Esos números son representaciones en hexadecimal de los colores que ves en la tabla.
Podés pasarle cualquier serie de colores, no sólo la creada con <code>spec_color</code>.</p>
<p>Así como se puede cambiar el estilo de las columnas con <code>column_spec</code>, se puede cambiar el estilo de las filas con <code>row_spec</code>.
Por ejemplo, se puede resaltar cada 2 líneas con este código:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb235-1" aria-hidden="true" tabindex="-1"></a>paises_tabla <span class="sc">%&gt;%</span> </span>
<span id="cb235-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb235-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(paises_seleccion), <span class="at">by =</span> <span class="dv">2</span>), <span class="at">background =</span> <span class="st">&quot;azure&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb235-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">&quot;top&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb235-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb235-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>() </span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
País
</th>
<th style="text-align:left;">
Año
</th>
<th style="text-align:right;">
Esperanza de vida
</th>
<th style="text-align:right;">
Población
</th>
<th style="text-align:right;">
PBI per cápita
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Argentina
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
74,340
</td>
<td style="text-align:right;">
38.331.121
</td>
<td style="text-align:right;">
8.797,641
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
2007
</td>
<td style="text-align:right;background-color: azure !important;">
75,320
</td>
<td style="text-align:right;background-color: azure !important;">
40.301.927
</td>
<td style="text-align:right;background-color: azure !important;">
12.779,380
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Chile
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
77,860
</td>
<td style="text-align:right;">
15.497.046
</td>
<td style="text-align:right;">
10.778,784
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
2007
</td>
<td style="text-align:right;background-color: azure !important;">
78,553
</td>
<td style="text-align:right;background-color: azure !important;">
16.284.741
</td>
<td style="text-align:right;background-color: azure !important;">
13.171,639
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Uruguay
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
75,307
</td>
<td style="text-align:right;">
3.363.085
</td>
<td style="text-align:right;">
7.727,002
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
2007
</td>
<td style="text-align:right;background-color: azure !important;">
76,384
</td>
<td style="text-align:right;background-color: azure !important;">
3.447.496
</td>
<td style="text-align:right;background-color: azure !important;">
10.611,463
</td>
</tr>
</tbody>
</table>
<p><code>row_spec</code> está cambiando el fondo (background) al color “azure” (que es ese celestito) a las filas indicadas por <code>seq(2, nrow(paises_seleccion), by = 2)</code>.
¿Qué es eso?
<code>seq</code> genera una secuencia (de <strong>seq</strong>uence) de números empezando en 2, terminando en la cantidad de filas de <code>paises_seleccion</code> y saltando de a dos.
En resumen:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">nrow</span>(paises_seleccion), <span class="at">by =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 2 4 6</code></pre>
<p>Como caso especial, se puede usar <code>row = 0</code> en <code>row_spec</code> para cambiar el formato del encabezado.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb238-1" aria-hidden="true" tabindex="-1"></a>paises_tabla <span class="sc">%&gt;%</span> </span>
<span id="cb238-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="at">row =</span> <span class="dv">0</span>, <span class="at">underline =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb238-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">&quot;top&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb238-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>() </span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;text-decoration: underline;">
País
</th>
<th style="text-align:left;text-decoration: underline;">
Año
</th>
<th style="text-align:right;text-decoration: underline;">
Esperanza de vida
</th>
<th style="text-align:right;text-decoration: underline;">
Población
</th>
<th style="text-align:right;text-decoration: underline;">
PBI per cápita
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Argentina
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
74,340
</td>
<td style="text-align:right;">
38.331.121
</td>
<td style="text-align:right;">
8.797,641
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
75,320
</td>
<td style="text-align:right;">
40.301.927
</td>
<td style="text-align:right;">
12.779,380
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Chile
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
77,860
</td>
<td style="text-align:right;">
15.497.046
</td>
<td style="text-align:right;">
10.778,784
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
78,553
</td>
<td style="text-align:right;">
16.284.741
</td>
<td style="text-align:right;">
13.171,639
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="2">
Uruguay
</td>
<td style="text-align:left;">
2002
</td>
<td style="text-align:right;">
75,307
</td>
<td style="text-align:right;">
3.363.085
</td>
<td style="text-align:right;">
7.727,002
</td>
</tr>
<tr>
<td style="text-align:left;">
2007
</td>
<td style="text-align:right;">
76,384
</td>
<td style="text-align:right;">
3.447.496
</td>
<td style="text-align:right;">
10.611,463
</td>
</tr>
</tbody>
</table>
<p>Esto es sólo una mínima parte de lo que se puede hacer con el paquete {kableExtra}.
Para ejemplos mucho más detallados, te recomendamos leer <a href="https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html">la viñeta completa</a></p>

</div>
<div id="apariencia-de-gráficos" class="section level2" number="7.16">
<h2><span class="header-section-number">7.16</span> Apariencia de gráficos</h2>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb239-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
</div>
<div id="escalas" class="section level2" number="7.17">
<h2><span class="header-section-number">7.17</span> Escalas</h2>
<p><a href="06-graficos-I.html">Previamente</a> comentamos que el <em>mapeo</em> de una variable en un elemento geométrico, por ejemplo cuando le asignamos distintos colores a los puntos que representan cada continente, usa una <strong>escala</strong> para definir, en este caso, que color le corresponde a cada elemento.</p>
<p>También cambiamos la apariencia del relleno (o <code>fill</code>) de barras y la forma de los puntos (o <code>shape</code>).
Para esto, {ggplot2} siempre usa una escala que podemos modificar de acuerdo a nuestro gusto y teniendo en cuenta cómo queremos comunicar nuestros resultados.</p>
<p>Por supuesto, modificar una escala implica sumar una nueva capa al gráfico sumando una nueva función.
Todas las funciones de escala comienzan con <code>scale</code> (de escala en inglés), el tipo de apariencia que queremos modificar (<code>color</code>, <code>fill</code>, <code>shape</code>, etc) y en muchos casos un nombre o una característica de esa escala.</p>
<p>Para mostrar como funciona, vamos a utilizar la base de datos de países y con suerte al final de este documento tendremos un gráfico listo para publicar.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb240-1" aria-hidden="true" tabindex="-1"></a>paises <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;datos/paises.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 1704 Columns: 6</code></pre>
<pre><code>## ── Column specification ─────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (2): pais, continente
## dbl (4): anio, esperanza_de_vida, poblacion, pib_per_capita</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb244-1" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb244-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb244-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb244-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb244-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pib_per_capita, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb244-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb244-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="DT6_files/figure-html/unnamed-chunk-129-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div id="escala-de-colores-y-otras" class="section level3" number="7.17.1">
<h3><span class="header-section-number">7.17.1</span> Escala de colores y otras</h3>
<p>Lo primero que podemos hacer es cambiar el color de los puntos de a cuerdo al continente.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb245-1" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb245-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb245-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb245-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb245-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pib_per_capita, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb245-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb245-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continente))</span></code></pre></div>
<p><img src="DT6_files/figure-html/unnamed-chunk-130-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Pero esta escala de colores que usa {ggplot2} por defecto no es de las mejores, de hecho las personas que tienen daltonísmo muy posiblemente no logren diferenciar todos los puntos.
Una escala o paleta de colores muy usada es <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html"><strong>viridis</strong></a> que fue creada justamente para resolver este y otros problemas.
También existe otra gran familia de paletas de colores llamada <a href="https://colorbrewer2.org/"><strong>ColorBrewer</strong></a>.</p>
<p>Vamos a probar la paleta “Dark2” de ColorBrewer, esta paleta es <em>qualitativa</em> y es justo lo que necesitamos para identificar elementos en categorías como los continentes.
Cómo estamos modificando el <em>color</em>, la función a usar será <code>scale_color_brewer()</code>:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb246-1" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb246-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb246-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pib_per_capita, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb246-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb246-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continente)) <span class="sc">+</span></span>
<span id="cb246-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb246-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>)</span></code></pre></div>
<p><img src="DT6_files/figure-html/unnamed-chunk-131-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Nuestro gráfico va quedando mejor y podemos aprovechar la capacidad de {ggplot2} de <em>mapear</em> variables a los elementos del gráfico y mostrar la población de cada país.</p>
<div class="alert alert-info">
<p><strong>Desafío</strong></p>
<p>A modo de prueba, cambia la paleta de colores actual por la de Viridis.
Para eso tenés que usar <code>scale_color_viridis_d()</code>.
La “d” del final viene de <em>discrete</em> y se usa para variables discretas o categorías, mientas que si los datos son continuos, se usa “c”.</p>
</div>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb247-1" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb247-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb247-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb247-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb247-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pib_per_capita, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb247-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb247-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continente, <span class="at">size =</span> poblacion)) <span class="sc">+</span></span>
<span id="cb247-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb247-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>)</span></code></pre></div>
<p><img src="DT6_files/figure-html/unnamed-chunk-132-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Esto nos da más información, pero al mismo tiempo vemos que los puntos se superponen.
Vamos a arreglar eso agregando transparencia y de paso modificar el tamaño de los puntos con la escala correspondiente <code>scale_size()</code> y sacar la legenda con <code>guide = NULL</code>.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb248-1" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb248-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb248-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb248-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pib_per_capita, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb248-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb248-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continente, <span class="at">size =</span> poblacion), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb248-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb248-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb248-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb248-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="DT6_files/figure-html/unnamed-chunk-133-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="escalas-de-ejes" class="section level3" number="7.17.2">
<h3><span class="header-section-number">7.17.2</span> Escalas de ejes</h3>
<p>Tal vez notaste que el comportamiento entre la esperanza de vida y el PBI no es lineal, de hecho el PBI varía mucho mientras que la esperanza de vida va apenas entre 40 y 80 y algo.
Eso puede esta indicando que el PBI tiene un comportamiento <em>logarítmico</em> y si bien podríamos transformar los datos antes de hacer el gráfico, también podemos elegir una escala logarítmica para el eje del gráfico correspondiente.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb249-1" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb249-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb249-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb249-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb249-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pib_per_capita, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb249-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb249-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continente, <span class="at">size =</span> poblacion), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb249-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb249-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb249-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb249-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb249-7"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb249-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span></code></pre></div>
<p><img src="DT6_files/figure-html/unnamed-chunk-134-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>En este caso las escalas que modifican los ejes justamente comienzan con <code>scala_x_</code> o <code>scale_y_</code> según sea el caso.
Y por supuesto hay una variedad importante de escalas con muchas opciones.</p>
</div>
</div>
<div id="elementos-de-texto" class="section level2" number="7.18">
<h2><span class="header-section-number">7.18</span> Elementos de texto</h2>
<p>Ya sumamos 3 escalas, pero el gráfico ya se ve muy bien.
¿Cómo hacemos si queremos identificar países individuales?
Por ahora es difícil, pero podríamos agregar etiquetas de texto con el nombre de cada país al lado de cada punto usando <code>geom_text()</code>, y en este caso la apariencia está dada por <code>label</code> o etiqueta:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb250-1" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb250-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb250-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb250-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb250-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pib_per_capita, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb250-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb250-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continente, <span class="at">size =</span> poblacion), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb250-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb250-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb250-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb250-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb250-7"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb250-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb250-8"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb250-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> pais)) </span></code></pre></div>
<p><img src="DT6_files/figure-html/unnamed-chunk-135-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Pero nos olvidamos que tenemos casi 200 países, es razonable agregarle etiquetas a todos.
Pero podríamos querer resaltar algunos, tal vez los de un continente en particular o los que cumplen con la condición de tener las mayores poblaciones del mundo.
Para eso vamos a generarnos una nueva tabla con los países que queremos resaltar y de paso usarla dentro de <code>geom_text()</code>.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-1" aria-hidden="true" tabindex="-1"></a>mucha_poblacion <span class="ot">&lt;-</span> paises <span class="sc">%&gt;%</span> </span>
<span id="cb251-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb251-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(poblacion <span class="sc">&gt;</span> <span class="dv">1000000000</span>) <span class="co"># Países con más de un billón de habitantes!</span></span>
<span id="cb251-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-5" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb251-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb251-7"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pib_per_capita, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb251-8"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continente, <span class="at">size =</span> poblacion), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb251-9"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb251-10"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb251-11"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb251-12"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> pais), </span>
<span id="cb251-13"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb251-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> mucha_poblacion)  <span class="co"># Esta capa usa la tabla mucha_población!</span></span></code></pre></div>
<p><img src="DT6_files/figure-html/unnamed-chunk-136-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="alert alert-success">
<p>Del código anterior surge algo muy importante: es posible generar capas en un gráfico usando una data.frame <em>distinto</em> al que usamos para graficar las capas anteriores.
Esto es útil principalmente para definir etiquetas o resaltar determinadas observaciones.</p>
<p>Y el truco está en que ambos data.frames tienen las variables <code>pib_per_capita</code> y <code>esperanza_de_vida</code> y entonces {ggplot2} puede identificar en que parte del gráfico (en que valores de x y en que valores de y) colocar cada elemento.</p>
</div>
<p>Veamos ahora una (de varias) maneras agregar o modificar elementos de texto en el gráfico.
Vamos a usar una nueva función (y una nueva capa!), <code>labs()</code>:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-1" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb252-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb252-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pib_per_capita, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb252-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continente, <span class="at">size =</span> poblacion), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb252-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb252-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb252-7"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb252-8"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> pais), <span class="at">data =</span> mucha_poblacion) <span class="sc">+</span></span>
<span id="cb252-9"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Paises del mundo&quot;</span>,</span>
<span id="cb252-10"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Año 2007&quot;</span>,</span>
<span id="cb252-11"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;El tamaño de cada circulo representa la población.&quot;</span>,</span>
<span id="cb252-12"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;PBI per capita&quot;</span>,</span>
<span id="cb252-13"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Esperanza de vida&quot;</span>,</span>
<span id="cb252-14"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb252-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="DT6_files/figure-html/unnamed-chunk-137-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Agregamos un título, un subtítulo, el epígrafe de la figura (<em>caption</em>) para las aclaraciones y cambiamos el nombre de los ejes para que se vean mejor.
Pero ademas eliminamos el nombre de la leyenda porque era un poco redundante.</p>
</div>
<div id="temas" class="section level2" number="7.19">
<h2><span class="header-section-number">7.19</span> Temas</h2>
<p>Nos queda una última cosa por hacer, cambiar la apariencia global del gráfico.
{ggplot2} tiene muchos <em>temas</em> disponibles y para todos los gustos.
Pero además hay otros paquetes que extienden las posibilidades, por ejemplo <a href="https://github.com/jrnold/ggthemes">{ggthemes}</a>.</p>
<p>Por defecto {ggplot2} usa <code>theme_grey()</code>, probemos <code>theme_light()</code>:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-1" aria-hidden="true" tabindex="-1"></a>paises <span class="sc">%&gt;%</span> </span>
<span id="cb253-2"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(anio <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb253-3"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(pib_per_capita, esperanza_de_vida)) <span class="sc">+</span></span>
<span id="cb253-4"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continente, <span class="at">size =</span> poblacion), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb253-5"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb253-6"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">15</span>, <span class="at">guide =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb253-7"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb253-8"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> pais), <span class="at">data =</span> mucha_poblacion) <span class="sc">+</span></span>
<span id="cb253-9"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Paises del mundo&quot;</span>,</span>
<span id="cb253-10"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Año 2007&quot;</span>,</span>
<span id="cb253-11"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;El tamaño de cada circulo representa la población.&quot;</span>,</span>
<span id="cb253-12"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;PBI per capita&quot;</span>,</span>
<span id="cb253-13"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Esperanza de vida&quot;</span>,</span>
<span id="cb253-14"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb253-15"><a href="manipulación-de-datos-ordenados-usando-dplyr-y-tidyr-ii.html#cb253-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="DT6_files/figure-html/unnamed-chunk-138-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="alert alert-info">
<p>Ahora es tu turno.
Elegí un <a href="https://es.r4ds.hadley.nz/images/visualization-themes.png" class="alert-link">tema que te guste</a> y probalo.
Además, si se te ocurre algún título mejor modificalo!</p>
</div>
<div class="alert alert-success">
<p>Junto con las funciones <code>theme_...()</code>, hay una función llamada <code>theme()</code> que permite cambiar la apariencia de cualquier elemento del gráfico.
Tiene casi infinitas opciones y si algún momento te desvelas intentando cambiar esa línea o ese borde, seguro que <code>theme()</code> tiene alguna opción para hacer eso.</p>
</div>
<div class="btn-group" role="group" aria-label="Navegación">
<p><a href= "11-tablas.html" class = "btn btn-primary">Anterior</a> <a href= "hoja-de-ruta.html" class = "btn btn-primary">Hoja de ruta</a></p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gráficos-con-ggplot2.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["DT6.pdf", "DT6.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
